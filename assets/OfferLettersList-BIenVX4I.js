import{r as t,B as O,j as e,O as Z}from"./index-njBTAYLF.js";import{G as _,p as $}from"./user-C1FB9O4a.js";const H=()=>{const[j,F]=t.useState([]),[c,r]=t.useState(1),[g,E]=t.useState(1),[p,I]=t.useState(0),[R,b]=t.useState(!1),[V,B]=t.useState(),[G,N]=t.useState(!0),[M,y]=t.useState(!1),[u,v]=t.useState(""),[i,S]=t.useState(""),[a,w]=t.useState(""),[l,D]=t.useState(""),Q=s=>{B(s),y(!0),N(!1)};t.useEffect(()=>{o(c,i,a,l)},[c]);const o=async(s,x="",m="",h="")=>{try{b(!0);const d={page:s,...x&&{search:x},...m&&{startDate:m},...h&&{endDate:h}},n=await _(d);console.log("===================================="),console.log(n,"response"),console.log("===================================="),n.success?(F(n.data),E(n.totalPages||1),I(n.total||0)):O.error(n.message||"Failed to fetch offer letters")}catch(d){O.error(d.message||"Something went wrong")}finally{b(!1)}},J=s=>{s.preventDefault(),r(1),S(u),o(1,u,a,l)},K=()=>{v(""),S(""),w(""),D(""),r(1),o(1,"","","")},W=()=>{r(1),o(1,i,a,l)};return e.jsxs(e.Fragment,{children:[G&&e.jsx("div",{className:"page-wrapper",children:e.jsx("div",{className:"content",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("h5",{className:"mb-0",children:["Offer Letter Count - ",p]}),(i||a||l)&&e.jsxs("div",{className:"active-filters",children:[e.jsx("span",{className:"badge bg-light text-dark me-2",children:"Active Filters:"}),i&&e.jsxs("span",{className:"badge bg-info me-2",children:['Search: "',i,'"']}),a&&e.jsxs("span",{className:"badge bg-info me-2",children:["From: ",new Date(a).toLocaleDateString()]}),l&&e.jsxs("span",{className:"badge bg-info me-2",children:["To: ",new Date(l).toLocaleDateString()]}),e.jsxs("button",{className:"btn btn-sm btn-outline-danger",onClick:K,children:[e.jsx("i",{className:"fas fa-times me-1"})," Clear All"]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("form",{onSubmit:J,className:"d-flex",children:[e.jsx("input",{type:"text",className:"form-control me-2",placeholder:"Search by candidate or company...",value:u,onChange:s=>v(s.target.value)}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-search me-1"})," Search"]})]})}),e.jsxs("div",{className:"col-md-6 d-flex",children:[e.jsxs("div",{className:"me-2",children:[e.jsx("label",{className:"form-label small",children:"Start Date"}),e.jsx("input",{type:"date",className:"form-control",value:a,onChange:s=>w(s.target.value)})]}),e.jsxs("div",{className:"me-2",children:[e.jsx("label",{className:"form-label small",children:"End Date"}),e.jsx("input",{type:"date",className:"form-control",value:l,onChange:s=>D(s.target.value)})]}),e.jsx("div",{className:"align-self-end",children:e.jsxs("button",{className:"btn btn-secondary",onClick:W,disabled:!a&&!l,children:[e.jsx("i",{className:"fas fa-filter me-1"})," Apply"]})})]})]}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("h4",{style:{textAlign:"center",fontWeight:"800",paddingTop:10,paddingBottom:25},children:["Offer Letter Total Count - ",p]}),R?e.jsxs("div",{className:"text-center my-4",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading job posts..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table border-0 comman-table datatable mb-0",style:{width:"100%",tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Branch Address"}),e.jsx("th",{children:"Job Title"}),e.jsx("th",{children:"employee Name"}),e.jsx("th",{children:"Issued At"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:j&&j.length>0?j.map((s,x)=>{var m,h,d,n,L,C,A,P,T,k;return e.jsxs("tr",{children:[e.jsx("td",{children:(c-1)*20+x+1}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((m=s==null?void 0:s.companyData)==null?void 0:m.companyLogo)||$,alt:"",height:40,width:40,style:{borderRadius:"50%",marginRight:"10px"}}),e.jsx("p",{className:"mb-0",children:((h=s==null?void 0:s.companyData)==null?void 0:h.companyName)||"N/A"})]})}),e.jsx("td",{children:e.jsx("p",{className:"mb-0",children:((d=s==null?void 0:s.branchData)==null?void 0:d.address)||"N/A"})}),e.jsx("td",{children:((n=s==null?void 0:s.jobTitleData)==null?void 0:n.title)||"N/A"}),e.jsx("td",{children:((C=(L=s==null?void 0:s.employeeData)==null?void 0:L.basicDetails)==null?void 0:C.name)||"-"}),e.jsx("td",{children:((A=s==null?void 0:s.employeeData)==null?void 0:A.phoneNumber)||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${((P=s==null?void 0:s.status)==null?void 0:P.employer)==="offerAccepted"?"bg-success":((T=s==null?void 0:s.status)==null?void 0:T.employer)==="offerRejected"?"bg-danger":"bg-warning"}`,children:((k=s==null?void 0:s.status)==null?void 0:k.employer)||"Pending"})}),e.jsx("td",{children:s!=null&&s.createdAt?new Date(s==null?void 0:s.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}):"-"}),e.jsx("td",{children:e.jsx("button",{className:"btn-primary text-white p-1 px-3",onClick:()=>Q(s),children:"View"})})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:e.jsxs("div",{className:"py-4",children:[e.jsx("i",{className:"fas fa-file-search fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No job posts found"}),(i||a||l)&&e.jsx("p",{children:"Try adjusting your search criteria or clear filters"})]})})})})]})})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>r(s=>Math.max(1,s-1)),disabled:c===1,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Previous"]}),e.jsxs("span",{className:"fw-bold",children:["Page ",c," of ",g]}),e.jsxs("button",{className:"btn btn-secondary",onClick:()=>r(s=>Math.min(g,s+1)),disabled:c===g,children:["Next ",e.jsx("i",{className:"fas fa-chevron-right ms-1"})]})]})]})})})})}),M&&e.jsx(Z,{offer:V,viewPage:y,listPage:N})]})};export{H as default};
