import{r as l,j as e,L as F}from"./index-DoX_k-mi.js";import{a as V}from"./users-BOEJXATY.js";import{p as T}from"./user-CZs_HDyx.js";import"./axiosInstance-BYKqn8JH.js";const J=()=>{const[f,D]=l.useState([]),[c,r]=l.useState(1),[m,S]=l.useState(1),[b,p]=l.useState(!1),[i,g]=l.useState(""),[a,v]=l.useState(""),[t,y]=l.useState(""),[N,u]=l.useState("");l.useEffect(()=>{h(c,i,a,t)},[c]);const h=async(s,x="",d="",o="")=>{try{p(!0);const n={page:s,...x&&{search:x},...d&&{startDate:d},...o&&{endDate:o}},j=await V(n);if(j.success){D(j.data);const A=j.totalPages||1;S(A)}else console.error("Failed to fetch users:",j.message||"Unknown error")}catch(n){console.error("Error fetching B2C users:",n)}finally{p(!1)}},w=()=>{c>1&&r(s=>s-1)},C=()=>{c<m&&r(s=>s+1)},L=s=>{s.preventDefault(),r(1),h(1,N,a,t),g(N)},P=()=>{u(""),g(""),v(""),y(""),r(1),h(1,"","","")},k=()=>{r(1),h(1,i,a,t)};return e.jsx("div",{className:"page-wrapper",children:e.jsx("div",{className:"content",children:e.jsxs("div",{children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h5",{className:"mb-0",children:"B2C Users List"}),(i||a||t)&&e.jsxs("div",{className:"active-filters",children:[e.jsx("span",{className:"badge bg-light text-dark me-2",children:"Active Filters:"}),i&&e.jsxs("span",{className:"badge bg-info me-2",children:['Search: "',i,'"']}),a&&e.jsxs("span",{className:"badge bg-info me-2",children:["From: ",new Date(a).toLocaleDateString()]}),t&&e.jsxs("span",{className:"badge bg-info me-2",children:["To: ",new Date(t).toLocaleDateString()]}),e.jsxs("button",{className:"btn btn-sm btn-outline-danger",onClick:P,children:[e.jsx("i",{className:"fas fa-times me-1"}),"Clear All"]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("form",{onSubmit:L,className:"d-flex",children:[e.jsx("input",{type:"text",className:"form-control me-2",placeholder:"Search by name, phone number, city...",value:N,onChange:s=>u(s.target.value)}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-search me-1"}),"Search"]})]}),e.jsx("small",{className:"text-muted",children:"Search by name, phone number, father's name, or contact information"})]}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"startDate",className:"form-label small",children:"Registration From"}),e.jsx("input",{type:"date",id:"startDate",className:"form-control",value:a,onChange:s=>v(s.target.value)})]})}),e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",className:"form-label small",children:"Registration To"}),e.jsx("input",{type:"date",id:"endDate",className:"form-control",value:t,onChange:s=>y(s.target.value)})]})}),e.jsx("div",{className:"col-md-2 d-flex align-items-end",children:e.jsx("button",{className:"btn btn-secondary w-100",onClick:k,disabled:!a&&!t,children:e.jsx("i",{className:"fas fa-filter"})})})]})})]})]})})}),e.jsx("div",{className:"row mt-3",children:b?e.jsxs("div",{className:"text-center my-4",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading users..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table border-0 custom-table comman-table datatable mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Photo"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Phone Number"}),e.jsx("th",{children:"Registration Date"}),e.jsx("th",{children:"Aadhar Verified"}),e.jsx("th",{children:"Applied Jobs"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:f.length>0?f.map((s,x)=>{var d,o,n;return e.jsxs("tr",{children:[e.jsx("td",{children:(c-1)*20+x+1}),e.jsx("td",{children:e.jsx("img",{src:(s==null?void 0:s.profile)||T,alt:"",height:50,width:50,style:{borderRadius:"50%",objectFit:"cover"}})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("span",{className:"fw-bold text-dark",children:((d=s==null?void 0:s.basicDetails)==null?void 0:d.name)||"-"}),((o=s==null?void 0:s.basicDetails)==null?void 0:o.city)&&e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-map-marker-alt me-1"}),s.basicDetails.city]})]})}),e.jsx("td",{children:s.phoneNumber||"-"}),e.jsx("td",{children:s.createdAt?new Date(s.createdAt).toLocaleDateString():"-"}),e.jsx("td",{children:s!=null&&s.isAadharphotoVerified&&(s!=null&&s.isDocumentVerified)||s!=null&&s.isAadharOtpVerfied?e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-check-circle me-1"})," Verified"]}):e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-times-circle me-1"})," Not Verified"]})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-info",children:((n=s==null?void 0:s.appliedJobs)==null?void 0:n.length)||0})}),e.jsx("td",{children:e.jsxs(F,{to:"/b2c-view",state:{user:s},className:"btn btn-sm btn-primary",children:[e.jsx("i",{className:"fas fa-eye me-1"})," View"]})})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center",children:e.jsxs("div",{className:"py-4",children:[e.jsx("i",{className:"fas fa-user-slash fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No users found"}),(i||a||t)&&e.jsx("p",{children:"Try adjusting your search criteria or clear filters"})]})})})})]})})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:w,disabled:c===1||b,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Previous"]}),e.jsxs("div",{className:"pagination-info",children:[e.jsxs("span",{className:"fw-bold",children:["Page ",c," of ",m]}),e.jsxs("div",{className:"text-muted small",children:["Showing ",f.length," of ",m*20," users"]})]}),e.jsxs("button",{className:"btn btn-secondary",onClick:C,disabled:c>=m||b,children:["Next ",e.jsx("i",{className:"fas fa-chevron-right ms-1"})]})]})]})})})};export{J as default};
