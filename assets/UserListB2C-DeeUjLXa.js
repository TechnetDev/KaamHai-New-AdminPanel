import{r as a,B as re,j as e,L as de}from"./index-B9EhzTRJ.js";import{a as oe}from"./users-D9z95VUr.js";import{p as me}from"./user-MtZiRSs5.js";import he from"./B2CView-DVaojkyH.js";import{F as xe,a as be}from"./index-C0wLxbQk.js";import{C as fe}from"./ConvertB2CButton-CNXSOgeL.js";const ye=()=>{const[u,D]=a.useState([]),[x,m]=a.useState(1),[y,M]=a.useState(1),[w,E]=a.useState(!1),[T,L]=a.useState(!0),[$,U]=a.useState(!1),[X,Y]=a.useState(),[B,ee]=a.useState(0),[o,O]=a.useState(""),[l,J]=a.useState(""),[i,R]=a.useState(""),[C,I]=a.useState(""),[t,W]=a.useState("all"),[n,Q]=a.useState("all"),[c,_]=a.useState("all"),[d,z]=a.useState("all"),[r,G]=a.useState("all"),[V,K]=a.useState(),se=async()=>{const s=await localStorage.getItem("adminData");try{const b=s?JSON.parse(s):null;K(b.admin)}catch(b){console.error("Failed to parse admin data:",b),K(null)}};a.useEffect(()=>{se()},[]),a.useEffect(()=>{h(x,o,l,i,t,n,c,d,r)},[x]);const h=async(s,b="",j="",p="",N="all",g="all",v="all",q="all",H="all")=>{try{E(!0);const F={page:s,...b&&{search:b},...j&&{startDate:j},...p&&{endDate:p},...N!=="all"&&{aadharVerified:N==="verified"},...g!=="all"&&{profileVerified:g==="verified"},...v!=="all"&&{appliedJobs:v==="applied"},...q!=="all"&&{currentEmployee:q==="current"},...H!=="all"&&{otpVerified:H==="verified"}},f=await oe(F);console.log(f,"response B2C Users"),f.success?(D(f.data),console.log(f.data),M(f.totalPages||1),ee(f.total)):(console.error("Failed to fetch users:",f.message||"Unknown error"),re.error(f.message||"Error fetching users"))}catch(F){console.error("Error fetching B2C users:",F)}finally{E(!1)}},ae=()=>{x>1&&m(s=>s-1)},le=()=>{x<y&&m(s=>s+1)},ie=s=>{s.preventDefault(),m(1),O(C),h(1,C,l,i,t,n,c,d,r)},te=()=>{I(""),O(""),J(""),R(""),W("all"),Q("all"),_("all"),z("all"),G("all"),m(1),h(1,"","","","all","all","all","all","all")},ne=()=>{m(1),h(1,o,l,i,t,n,c,d,r)},k=s=>{W(s),m(1),h(1,o,l,i,s,n,c,d,r)},S=s=>{Q(s),m(1),h(1,o,l,i,t,s,c,d,r)},A=s=>{_(s),m(1),h(1,o,l,i,t,n,s,d,r)},Z=s=>{z(s),m(1),h(1,o,l,i,t,n,c,s,r)},P=s=>{G(s),m(1),h(1,o,l,i,t,n,c,d,s)},ce=s=>{Y(s),L(!1),U(!0)};return e.jsxs(e.Fragment,{children:[T&&!$&&e.jsx("div",{className:"page-wrapper",children:e.jsxs("div",{className:"content",children:[e.jsx("div",{children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h5",{className:"mb-0",children:"B2C Users List"}),(o||l||i||t!=="all"||n!=="all"||c!=="all"||d!=="all"||r!=="all")&&e.jsxs("div",{className:"active-filters",children:[e.jsx("span",{className:"badge bg-light text-dark me-2",children:"Active Filters:"}),o&&e.jsxs("span",{className:"badge bg-info me-2",children:['Search: "',o,'"']}),l&&e.jsxs("span",{className:"badge bg-info me-2",children:["From: ",new Date(l).toLocaleDateString()]}),i&&e.jsxs("span",{className:"badge bg-info me-2",children:["To: ",new Date(i).toLocaleDateString()]}),t!=="all"&&e.jsxs("span",{className:"badge bg-info me-2",children:["Aadhar: ",t==="verified"?"Verified":"Not Verified"]}),n!=="all"&&e.jsxs("span",{className:"badge bg-info me-2",children:["Profile: ",n==="verified"?"Verified":"Not Verified"]}),c!=="all"&&e.jsxs("span",{className:"badge bg-info me-2",children:["Applications: ",c==="applied"?"Applied":"Not Applied"]}),d!=="all"&&e.jsxs("span",{className:"badge bg-info me-2",children:["Employee: ",d==="current"?"Current":"New"]}),r!=="all"&&e.jsxs("span",{className:"badge bg-info me-2",children:["OTP Verified: ",r==="verified"?"Verified":"Not Verified"]}),e.jsxs("button",{className:"btn btn-sm btn-outline-danger",onClick:te,children:[e.jsx("i",{className:"fas fa-times me-1"}),"Clear All"]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("form",{onSubmit:ie,className:"d-flex",children:[e.jsx("input",{type:"text",className:"form-control me-2",placeholder:"Search by name, phone number, city...",value:C,onChange:s=>I(s.target.value)}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-search me-1"}),"Search"]})]}),e.jsx("small",{className:"text-muted",children:"Search by name, phone number, father's name, or contact information"})]}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"startDate",className:"form-label small",children:"Registration From"}),e.jsx("input",{type:"date",id:"startDate",className:"form-control",value:l,onChange:s=>J(s.target.value)})]})}),e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",className:"form-label small",children:"Registration To"}),e.jsx("input",{type:"date",id:"endDate",className:"form-control",value:i,onChange:s=>R(s.target.value)})]})}),e.jsx("div",{className:"col-md-2 d-flex align-items-end",children:e.jsx("button",{className:"btn btn-secondary w-100",onClick:ne,disabled:!l&&!i,children:e.jsx("i",{className:"fas fa-filter"})})})]})})]}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card bg-light",children:e.jsx("div",{className:"card-body py-2",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-3",children:e.jsx("span",{className:"fw-medium",children:"Aadhar Status:"})}),e.jsx("div",{className:"col-md-9",children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx("button",{type:"button",className:`btn ${t==="all"?"btn-primary":"btn-outline-primary"}`,onClick:()=>k("all"),children:"All Users"}),e.jsxs("button",{type:"button",className:`btn ${t==="verified"?"btn-primary":"btn-outline-primary"}`,onClick:()=>k("verified"),children:[e.jsx("i",{className:"fas fa-check-circle me-1"}),"Aadhar Verified"]}),e.jsxs("button",{type:"button",className:`btn ${t==="notVerified"?"btn-primary":"btn-outline-primary"}`,onClick:()=>k("notVerified"),children:[e.jsx("i",{className:"fas fa-times-circle me-1"}),"Aadhar Not Verified"]})]})})]})})})})}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card bg-light",children:e.jsx("div",{className:"card-body py-2",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-3",children:e.jsx("span",{className:"fw-medium",children:"Profile Status:"})}),e.jsx("div",{className:"col-md-9",children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx("button",{type:"button",className:`btn ${n==="all"?"btn-warning":"btn-outline-warning"}`,onClick:()=>S("all"),children:"All Users"}),e.jsxs("button",{type:"button",className:`btn ${n==="verified"?"btn-warning":"btn-outline-warning"}`,onClick:()=>S("verified"),children:[e.jsx("i",{className:"fas fa-user-check me-1"}),"Profile Verified"]}),e.jsxs("button",{type:"button",className:`btn ${n==="notVerified"?"btn-warning":"btn-outline-warning"}`,onClick:()=>S("notVerified"),children:[e.jsx("i",{className:"fas fa-user-times me-1"}),"Profile Not Verified"]})]})})]})})})})}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card bg-light",children:e.jsx("div",{className:"card-body py-2",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-3",children:e.jsx("span",{className:"fw-medium",children:"OTP Verification Status:"})}),e.jsx("div",{className:"col-md-9",children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx("button",{type:"button",className:`btn ${r==="all"?"btn-dark":"btn-outline-dark"}`,onClick:()=>P("all"),children:"All Users"}),e.jsxs("button",{type:"button",className:`btn ${r==="verified"?"btn-dark":"btn-outline-dark"}`,onClick:()=>P("verified"),children:[e.jsx("i",{className:"fas fa-mobile-alt me-1"}),"OTP Verified"]}),e.jsxs("button",{type:"button",className:`btn ${r==="notVerified"?"btn-dark":"btn-outline-dark"}`,onClick:()=>P("notVerified"),children:[e.jsx("i",{className:"fas fa-mobile-alt me-1"}),"OTP Not Verified"]})]})})]})})})})}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card bg-light",children:e.jsx("div",{className:"card-body py-2",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-3",children:e.jsx("span",{className:"fw-medium",children:"Application Status:"})}),e.jsx("div",{className:"col-md-9",children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx("button",{type:"button",className:`btn ${c==="all"?"btn-info":"btn-outline-info"}`,onClick:()=>A("all"),children:"All Users"}),e.jsxs("button",{type:"button",className:`btn ${c==="applied"?"btn-info":"btn-outline-info"}`,onClick:()=>A("applied"),children:[e.jsx("i",{className:"fas fa-paper-plane me-1"}),"Applied for Jobs"]}),e.jsxs("button",{type:"button",className:`btn ${c==="notApplied"?"btn-info":"btn-outline-info"}`,onClick:()=>A("notApplied"),children:[e.jsx("i",{className:"fas fa-user-clock me-1"}),"Not Applied"]})]})})]})})})})}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card bg-light",children:e.jsx("div",{className:"card-body py-2",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-3",children:e.jsx("span",{className:"fw-medium",children:"Employee Status:"})}),e.jsx("div",{className:"col-md-9",children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx("button",{type:"button",className:`btn ${d==="all"?"btn-success":"btn-outline-success"}`,onClick:()=>Z("all"),children:"All Users"}),e.jsxs("button",{type:"button",className:`btn ${d==="current"?"btn-success":"btn-outline-success"}`,onClick:()=>Z("current"),children:[e.jsx("i",{className:"fas fa-briefcase me-1"}),"Current Employee"]})]})})]})})})})})]})})})}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("h4",{style:{textAlign:"center",fontWeight:"800",paddingTop:10,paddingBottom:25},children:["Total Count - ",B]}),w?e.jsxs("div",{className:"text-center my-4",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading users..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table border-0 custom-table comman-table datatable mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Photo"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Phone Number"}),e.jsx("th",{children:"Registration Date"}),e.jsx("th",{children:"Aadhar Verified"}),e.jsx("th",{children:"Profile Verified"}),e.jsx("th",{children:"OTP Verified"}),e.jsx("th",{children:"Current Employee"}),e.jsx("th",{children:"Applied Jobs"}),e.jsx("th",{children:"Action"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:u.length>0?u.map((s,b)=>{var j,p,N,g,v;return e.jsxs("tr",{children:[e.jsx("td",{children:(x-1)*20+b+1}),e.jsx("td",{children:e.jsx("img",{src:(s==null?void 0:s.profile)||me,alt:"",height:50,width:50,style:{borderRadius:"50%",objectFit:"cover"}})}),e.jsx("td",{children:e.jsx("div",{className:"d-flex flex-column",children:e.jsx("span",{className:"fw-bold text-dark",children:((j=s==null?void 0:s.basicDetails)==null?void 0:j.name)||"-"})})}),e.jsx("td",{style:{width:"200px",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"normal"},children:((p=s==null?void 0:s.basicDetails)==null?void 0:p.city)&&e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-map-marker-alt me-1"}),s.basicDetails.city,((g=(N=s==null?void 0:s.workPreference)==null?void 0:N.jobLocation)==null?void 0:g.length)>0&&`, ${s.workPreference.jobLocation.join(", ")}`]})}),e.jsxs("td",{children:[s.otpVerified?e.jsx(xe,{style:{color:"green",marginRight:"2px",fontSize:"15px"}}):e.jsx(be,{style:{color:"red",marginRight:"2px"}}),s.phoneNumber||"-"," "]}),e.jsx("td",{children:s.createdAt?new Date(s.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}):"-"}),e.jsx("td",{children:s!=null&&s.isAadharphotoVerified&&(s!=null&&s.isDocumentVerified)||s!=null&&s.isAadharOtpVerfied?e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-check-circle me-1"})," Verified"]}):e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-times-circle me-1"})," Not Verified"]})}),e.jsx("td",{children:s!=null&&s.isPhotoVerified?e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-check-circle me-1"})," Verified"]}):e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-times-circle me-1"})," Not Verified"]})}),e.jsx("td",{children:s!=null&&s.otpVerified?e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-mobile-alt me-1"})," OTP Verified"]}):e.jsxs("span",{className:"badge bg-danger",children:[e.jsx("i",{className:"fas fa-mobile-alt me-1"})," OTP Not Verified"]})}),e.jsx("td",{children:s!=null&&s.isCurrentEmployee?e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-check-circle me-1"})," Current Employee"]}):e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-times-circle me-1"})," New Employee"]})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-info",children:((v=s==null?void 0:s.appliedJobs)==null?void 0:v.length)||0})}),e.jsx("td",{onClick:()=>ce(s),children:e.jsxs(de,{state:{user:s},className:"btn btn-sm btn-primary",children:[e.jsx("i",{className:"fas fa-eye me-1"})," View"]})}),(V==null?void 0:V.isEdit)&&e.jsx("td",{children:s!=null&&s.isAadharphotoVerified||s!=null&&s.isAadharOtpVerfied?"":e.jsx(fe,{userId:s==null?void 0:s._id,fetchUsers:h,role:"B2B"})})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"14",className:"text-center",children:e.jsxs("div",{className:"py-4",children:[e.jsx("i",{className:"fas fa-user-slash fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No users found"}),(o||l||i||t!=="all"||n!=="all"||c!=="all"||d!=="all"||r!=="all")&&e.jsx("p",{children:"Try adjusting your search criteria or clear filters"})]})})})})]})})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:ae,disabled:x===1||w,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Previous"]}),e.jsxs("div",{className:"pagination-info",children:[e.jsxs("span",{className:"fw-bold",children:["Page ",x," of ",y]}),e.jsxs("div",{className:"text-muted small",children:["Showing ",u.length," of ",B," users"]})]}),e.jsxs("button",{className:"btn btn-secondary",onClick:le,disabled:x>=y||w,children:["Next ",e.jsx("i",{className:"fas fa-chevron-right ms-1"})]})]})]})}),$&&!T&&e.jsx(he,{user:X,setListPage:L,setViewPage:U,users:u,setUsers:D})]})};export{ye as default};
