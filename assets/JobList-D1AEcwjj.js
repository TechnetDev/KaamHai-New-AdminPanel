import{r as l,j as e,L as T}from"./index-DoX_k-mi.js";import{p as J}from"./user-CZs_HDyx.js";import{i as R}from"./axiosInstance-BYKqn8JH.js";const $=async a=>{try{let t=`page=${a.page}`;return a.search&&(t+=`&search=${encodeURIComponent(a.search)}`),a.startDate&&(t+=`&startDate=${encodeURIComponent(a.startDate)}`),a.endDate&&(t+=`&endDate=${encodeURIComponent(a.endDate)}`),(await R.get(`admin/jobPostList?${t}`)).data}catch(t){return t.response?t.response.data:t.request?{success:!1,message:"No response received from server"}:{success:!1,message:t.message||"Error occurred while making the request"}}},V=()=>{const[a,t]=l.useState([]),[n,o]=l.useState(1),[j,L]=l.useState(1),[g,v]=l.useState(!1),[m,y]=l.useState(""),[r,D]=l.useState(""),[c,w]=l.useState(""),[f,p]=l.useState("");l.useEffect(()=>{b(n,m,r,c)},[n]);const b=async(s,u="",h="",x="")=>{try{v(!0);const i={page:s,...u&&{search:u},...h&&{startDate:h},...x&&{endDate:x}};console.log("Fetching with params:",i);const d=await $(i);if(d.success){t(d.data);const N=d.totalPages||1;L(N)}else console.error("Failed to fetch jobs:",d.message||"Unknown error")}catch(i){console.error("Error fetching job posts:",i)}finally{v(!1)}},A=()=>{n>1&&o(s=>s-1)},k=()=>{n<j&&o(s=>s+1)},F=s=>{s.preventDefault(),o(1),b(1,f,r,c),y(f)},I=()=>{p(""),y(""),D(""),w(""),o(1),b(1,"","","")},E=()=>{o(1),b(1,m,r,c)};return e.jsx("div",{className:"page-wrapper",children:e.jsx("div",{className:"content",children:e.jsxs("div",{children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h5",{className:"mb-0",children:"Job Post List"}),(m||r||c)&&e.jsxs("div",{className:"active-filters",children:[e.jsx("span",{className:"badge bg-light text-dark me-2",children:"Active Filters:"}),m&&e.jsxs("span",{className:"badge bg-info me-2",children:['Search: "',m,'"']}),r&&e.jsxs("span",{className:"badge bg-info me-2",children:["From: ",new Date(r).toLocaleDateString()]}),c&&e.jsxs("span",{className:"badge bg-info me-2",children:["To: ",new Date(c).toLocaleDateString()]}),e.jsxs("button",{className:"btn btn-sm btn-outline-danger",onClick:I,children:[e.jsx("i",{className:"fas fa-times me-1"}),"Clear All"]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("form",{onSubmit:F,className:"d-flex",children:[e.jsx("input",{type:"text",className:"form-control me-2",placeholder:"Search job title, company, business owner...",value:f,onChange:s=>p(s.target.value)}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-search me-1"}),"Search"]})]}),e.jsx("small",{className:"text-muted",children:"Search across job titles, descriptions, company names, or business owner details"})]}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"startDate",className:"form-label small",children:"Start Date"}),e.jsx("input",{type:"date",id:"startDate",className:"form-control",value:r,onChange:s=>D(s.target.value)})]})}),e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",className:"form-label small",children:"End Date"}),e.jsx("input",{type:"date",id:"endDate",className:"form-control",value:c,onChange:s=>w(s.target.value)})]})}),e.jsx("div",{className:"col-md-2 d-flex align-items-end",children:e.jsx("button",{className:"btn btn-secondary w-100",onClick:E,disabled:!r&&!c,children:e.jsx("i",{className:"fas fa-filter"})})})]})})]})]})})}),e.jsx("div",{className:"row mt-3",children:g?e.jsxs("div",{className:"text-center my-4",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading job posts..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table border-0 comman-table datatable mb-0",style:{width:"100%",tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Address"}),e.jsx("th",{children:"Job Title"}),e.jsx("th",{children:"Business Owner"}),e.jsx("th",{children:"Phone Number"}),e.jsx("th",{children:"Applicants"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:a&&a.length>0?a.map((s,u)=>{var h,x,i,d,N,S,P,C;return e.jsxs("tr",{children:[e.jsx("td",{children:(n-1)*20+u+1}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((h=s==null?void 0:s.companyId)==null?void 0:h.companyLogo)||J,alt:"",height:40,width:40,style:{borderRadius:"50%",marginRight:"10px"}}),e.jsx("p",{className:"mb-0",children:((x=s==null?void 0:s.companyId)==null?void 0:x.companyName)||"N/A"})]})}),e.jsx("td",{children:e.jsx("p",{className:"mb-0",children:((i=s==null?void 0:s.branchData)==null?void 0:i.address)||"N/A"})}),e.jsx("td",{children:((d=s==null?void 0:s.jobTitle)==null?void 0:d.title)||"N/A"}),e.jsx("td",{children:((N=s==null?void 0:s.userId)==null?void 0:N.name)||"-"}),e.jsx("td",{children:((S=s==null?void 0:s.userId)==null?void 0:S.phoneNumber)||"-"}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-info",children:((C=(P=s==null?void 0:s.applicants)==null?void 0:P.applicants)==null?void 0:C.length)||0})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s!=null&&s.paymentDone?"bg-success":"bg-warning"}`,children:(s==null?void 0:s.paymentDone)===!0?"Paid":"Unpaid"})}),e.jsx("td",{children:s!=null&&s.createdAt?new Date(s.createdAt).toLocaleDateString():"N/A"}),e.jsx("td",{children:e.jsx(T,{to:"/jobView",state:{post:s},className:"btn btn-sm btn-primary",children:"View"})})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:e.jsxs("div",{className:"py-4",children:[e.jsx("i",{className:"fas fa-file-search fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No job posts found"}),(m||r||c)&&e.jsx("p",{children:"Try adjusting your search criteria or clear filters"})]})})})})]})})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:A,disabled:n===1||g,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Previous"]}),e.jsxs("div",{className:"pagination-info",children:[e.jsxs("span",{className:"fw-bold",children:["Page ",n," of ",j]}),e.jsxs("div",{className:"text-muted small",children:["Showing ",a.length," of ",j*20," job posts"]})]}),e.jsxs("button",{className:"btn btn-secondary",onClick:k,disabled:n>=j||g,children:["Next ",e.jsx("i",{className:"fas fa-chevron-right ms-1"})]})]})]})})})};export{V as default};
