import{r as a,B as te,j as e,L as ie}from"./index-Dk5Um9CU.js";import{a as ne}from"./users-mnCF1yFY.js";import{p as ce}from"./user-Br-LvHhI.js";import re from"./B2CView-Dzx0TqBi.js";import{C as de}from"./ConvertB2CButton-BtExX0MP.js";const be=()=>{const[u,D]=a.useState([]),[h,o]=a.useState(1),[v,Z]=a.useState(1),[y,P]=a.useState(!1),[F,E]=a.useState(!0),[L,U]=a.useState(!1),[q,z]=a.useState(),[$,H]=a.useState(0),[d,B]=a.useState(""),[l,J]=a.useState(""),[t,T]=a.useState(""),[w,I]=a.useState(""),[i,R]=a.useState("all"),[n,O]=a.useState("all"),[c,W]=a.useState("all"),[r,Q]=a.useState("all"),[C,_]=a.useState(),M=async()=>{const s=await localStorage.getItem("adminData");try{const x=s?JSON.parse(s):null;_(x.admin)}catch(x){console.error("Failed to parse admin data:",x),_(null)}};a.useEffect(()=>{M()},[]),a.useEffect(()=>{m(h,d,l,t,i,n,c,r)},[h]);const m=async(s,x="",b="",f="",p="all",N="all",g="all",K="all")=>{try{P(!0);const k={page:s,...x&&{search:x},...b&&{startDate:b},...f&&{endDate:f},...p!=="all"&&{aadharVerified:p==="verified"},...N!=="all"&&{profileVerified:N==="verified"},...g!=="all"&&{appliedJobs:g==="applied"},...K!=="all"&&{currentEmployee:K==="current"}},j=await ne(k);console.log(j,"response B2C Users"),j.success?(D(j.data),console.log(j.data),Z(j.totalPages||1),H(j.total)):(console.error("Failed to fetch users:",j.message||"Unknown error"),te.error(j.message||"Error fetching users"))}catch(k){console.error("Error fetching B2C users:",k)}finally{P(!1)}},X=()=>{h>1&&o(s=>s-1)},Y=()=>{h<v&&o(s=>s+1)},ee=s=>{s.preventDefault(),o(1),B(w),m(1,w,l,t,i,n,c,r)},se=()=>{I(""),B(""),J(""),T(""),R("all"),O("all"),W("all"),Q("all"),o(1),m(1,"","","","all","all","all","all")},ae=()=>{o(1),m(1,d,l,t,i,n,c,r)},A=s=>{R(s),o(1),m(1,d,l,t,s,n,c,r)},S=s=>{O(s),o(1),m(1,d,l,t,i,s,c,r)},V=s=>{W(s),o(1),m(1,d,l,t,i,n,s,r)},G=s=>{Q(s),o(1),m(1,d,l,t,i,n,c,s)},le=s=>{z(s),E(!1),U(!0)};return e.jsxs(e.Fragment,{children:[F&&!L&&e.jsx("div",{className:"page-wrapper",children:e.jsxs("div",{className:"content",children:[e.jsx("div",{children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h5",{className:"mb-0",children:"B2C Users List"}),(d||l||t||i!=="all"||n!=="all"||c!=="all"||r!=="all")&&e.jsxs("div",{className:"active-filters",children:[e.jsx("span",{className:"badge bg-light text-dark me-2",children:"Active Filters:"}),d&&e.jsxs("span",{className:"badge bg-info me-2",children:['Search: "',d,'"']}),l&&e.jsxs("span",{className:"badge bg-info me-2",children:["From: ",new Date(l).toLocaleDateString()]}),t&&e.jsxs("span",{className:"badge bg-info me-2",children:["To: ",new Date(t).toLocaleDateString()]}),i!=="all"&&e.jsxs("span",{className:"badge bg-info me-2",children:["Aadhar: ",i==="verified"?"Verified":"Not Verified"]}),n!=="all"&&e.jsxs("span",{className:"badge bg-info me-2",children:["Profile: ",n==="verified"?"Verified":"Not Verified"]}),c!=="all"&&e.jsxs("span",{className:"badge bg-info me-2",children:["Applications: ",c==="applied"?"Applied":"Not Applied"]}),r!=="all"&&e.jsxs("span",{className:"badge bg-info me-2",children:["Employee: ",r==="current"?"Current":"New"]}),e.jsxs("button",{className:"btn btn-sm btn-outline-danger",onClick:se,children:[e.jsx("i",{className:"fas fa-times me-1"}),"Clear All"]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("form",{onSubmit:ee,className:"d-flex",children:[e.jsx("input",{type:"text",className:"form-control me-2",placeholder:"Search by name, phone number, city...",value:w,onChange:s=>I(s.target.value)}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-search me-1"}),"Search"]})]}),e.jsx("small",{className:"text-muted",children:"Search by name, phone number, father's name, or contact information"})]}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"startDate",className:"form-label small",children:"Registration From"}),e.jsx("input",{type:"date",id:"startDate",className:"form-control",value:l,onChange:s=>J(s.target.value)})]})}),e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",className:"form-label small",children:"Registration To"}),e.jsx("input",{type:"date",id:"endDate",className:"form-control",value:t,onChange:s=>T(s.target.value)})]})}),e.jsx("div",{className:"col-md-2 d-flex align-items-end",children:e.jsx("button",{className:"btn btn-secondary w-100",onClick:ae,disabled:!l&&!t,children:e.jsx("i",{className:"fas fa-filter"})})})]})})]}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card bg-light",children:e.jsx("div",{className:"card-body py-2",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-3",children:e.jsx("span",{className:"fw-medium",children:"Aadhar Status:"})}),e.jsx("div",{className:"col-md-9",children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx("button",{type:"button",className:`btn ${i==="all"?"btn-primary":"btn-outline-primary"}`,onClick:()=>A("all"),children:"All Users"}),e.jsxs("button",{type:"button",className:`btn ${i==="verified"?"btn-primary":"btn-outline-primary"}`,onClick:()=>A("verified"),children:[e.jsx("i",{className:"fas fa-check-circle me-1"}),"Aadhar Verified"]}),e.jsxs("button",{type:"button",className:`btn ${i==="notVerified"?"btn-primary":"btn-outline-primary"}`,onClick:()=>A("notVerified"),children:[e.jsx("i",{className:"fas fa-times-circle me-1"}),"Aadhar Not Verified"]})]})})]})})})})}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card bg-light",children:e.jsx("div",{className:"card-body py-2",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-3",children:e.jsx("span",{className:"fw-medium",children:"Profile Status:"})}),e.jsx("div",{className:"col-md-9",children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx("button",{type:"button",className:`btn ${n==="all"?"btn-warning":"btn-outline-warning"}`,onClick:()=>S("all"),children:"All Users"}),e.jsxs("button",{type:"button",className:`btn ${n==="verified"?"btn-warning":"btn-outline-warning"}`,onClick:()=>S("verified"),children:[e.jsx("i",{className:"fas fa-user-check me-1"}),"Profile Verified"]}),e.jsxs("button",{type:"button",className:`btn ${n==="notVerified"?"btn-warning":"btn-outline-warning"}`,onClick:()=>S("notVerified"),children:[e.jsx("i",{className:"fas fa-user-times me-1"}),"Profile Not Verified"]})]})})]})})})})}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card bg-light",children:e.jsx("div",{className:"card-body py-2",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-3",children:e.jsx("span",{className:"fw-medium",children:"Application Status:"})}),e.jsx("div",{className:"col-md-9",children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx("button",{type:"button",className:`btn ${c==="all"?"btn-info":"btn-outline-info"}`,onClick:()=>V("all"),children:"All Users"}),e.jsxs("button",{type:"button",className:`btn ${c==="applied"?"btn-info":"btn-outline-info"}`,onClick:()=>V("applied"),children:[e.jsx("i",{className:"fas fa-paper-plane me-1"}),"Applied for Jobs"]}),e.jsxs("button",{type:"button",className:`btn ${c==="notApplied"?"btn-info":"btn-outline-info"}`,onClick:()=>V("notApplied"),children:[e.jsx("i",{className:"fas fa-user-clock me-1"}),"Not Applied"]})]})})]})})})})}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card bg-light",children:e.jsx("div",{className:"card-body py-2",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-3",children:e.jsx("span",{className:"fw-medium",children:"Employee Status:"})}),e.jsx("div",{className:"col-md-9",children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx("button",{type:"button",className:`btn ${r==="all"?"btn-success":"btn-outline-success"}`,onClick:()=>G("all"),children:"All Users"}),e.jsxs("button",{type:"button",className:`btn ${r==="current"?"btn-success":"btn-outline-success"}`,onClick:()=>G("current"),children:[e.jsx("i",{className:"fas fa-briefcase me-1"}),"Current Employee"]})]})})]})})})})})]})})})}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("h4",{style:{textAlign:"center",fontWeight:"800",paddingTop:10,paddingBottom:25},children:["Total Count - ",$]}),y?e.jsxs("div",{className:"text-center my-4",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading users..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table border-0 custom-table comman-table datatable mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Photo"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Phone Number"}),e.jsx("th",{children:"Registration Date"}),e.jsx("th",{children:"Aadhar Verified"}),e.jsx("th",{children:"Profile Verified"}),e.jsx("th",{children:"Current Employee"}),e.jsx("th",{children:"Applied Jobs"}),e.jsx("th",{children:"Action"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:u.length>0?u.map((s,x)=>{var b,f,p,N,g;return e.jsxs("tr",{children:[e.jsx("td",{children:(h-1)*20+x+1}),e.jsx("td",{children:e.jsx("img",{src:(s==null?void 0:s.profile)||ce,alt:"",height:50,width:50,style:{borderRadius:"50%",objectFit:"cover"}})}),e.jsx("td",{children:e.jsx("div",{className:"d-flex flex-column",children:e.jsx("span",{className:"fw-bold text-dark",children:((b=s==null?void 0:s.basicDetails)==null?void 0:b.name)||"-"})})}),e.jsx("td",{style:{width:"200px",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"normal"},children:((f=s==null?void 0:s.basicDetails)==null?void 0:f.city)&&e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-map-marker-alt me-1"}),s.basicDetails.city,((N=(p=s==null?void 0:s.workPreference)==null?void 0:p.jobLocation)==null?void 0:N.length)>0&&`, ${s.workPreference.jobLocation.join(", ")}`]})}),e.jsx("td",{children:s.phoneNumber||"-"}),e.jsx("td",{children:s.createdAt?new Date(s.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}):"-"}),e.jsx("td",{children:s!=null&&s.isAadharphotoVerified&&(s!=null&&s.isDocumentVerified)||s!=null&&s.isAadharOtpVerfied?e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-check-circle me-1"})," Verified"]}):e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-times-circle me-1"})," Not Verified"]})}),e.jsx("td",{children:s!=null&&s.isPhotoVerified?e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-check-circle me-1"})," Verified"]}):e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-times-circle me-1"})," Not Verified"]})}),e.jsx("td",{children:s!=null&&s.isCurrentEmployee?e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-check-circle me-1"})," Current Employee"]}):e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-times-circle me-1"})," New Employee"]})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-info",children:((g=s==null?void 0:s.appliedJobs)==null?void 0:g.length)||0})}),e.jsx("td",{onClick:()=>le(s),children:e.jsxs(ie,{state:{user:s},className:"btn btn-sm btn-primary",children:[e.jsx("i",{className:"fas fa-eye me-1"})," View"]})}),(C==null?void 0:C.isEdit)&&e.jsx("td",{children:s!=null&&s.isAadharphotoVerified||s!=null&&s.isAadharOtpVerfied?"":e.jsx(de,{userId:s==null?void 0:s._id,fetchUsers:m,role:"B2C"})})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:e.jsxs("div",{className:"py-4",children:[e.jsx("i",{className:"fas fa-user-slash fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No users found"}),(d||l||t||i!=="all"||n!=="all"||c!=="all"||r!=="all")&&e.jsx("p",{children:"Try adjusting your search criteria or clear filters"})]})})})})]})})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:X,disabled:h===1||y,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Previous"]}),e.jsxs("div",{className:"pagination-info",children:[e.jsxs("span",{className:"fw-bold",children:["Page ",h," of ",v]}),e.jsxs("div",{className:"text-muted small",children:["Showing ",u.length," of ",$," users"]})]}),e.jsxs("button",{className:"btn btn-secondary",onClick:Y,disabled:h>=v||y,children:["Next ",e.jsx("i",{className:"fas fa-chevron-right ms-1"})]})]})]})}),L&&!F&&e.jsx(re,{user:q,setListPage:E,setViewPage:U,users:u,setUsers:D})]})};export{be as default};
