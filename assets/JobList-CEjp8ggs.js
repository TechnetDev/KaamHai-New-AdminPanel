import{r as a,j as e,L as H}from"./index-C9dZETk3.js";import{p as K}from"./user-CZs_HDyx.js";import{G as W}from"./Job-DK00F8cP.js";import"./axiosInstance-D-EDd5kP.js";const X=()=>{const[p,J]=a.useState([]),[i,m]=a.useState(1),[y,E]=a.useState(1),[S,O]=a.useState(0),[w,P]=a.useState(!1),[d,C]=a.useState(""),[n,F]=a.useState(""),[l,A]=a.useState(""),[D,L]=a.useState(""),[t,k]=a.useState(""),[c,T]=a.useState(""),[h,_]=a.useState("desc");a.useEffect(()=>{j(i,d,n,l,t,c,h)},[i]);const j=async(s,o="",b="",u="",N="",g="",f="desc")=>{try{P(!0);const x={page:s,...o&&{search:o},...b&&{startDate:b},...u&&{endDate:u},...N&&{paymentStatus:N},...g&&{sortBy:g},...f&&{sortOrder:f}};console.log("Fetching with params:",x);const r=await W(x);if(r.success){J(r.data);const v=r.totalPages||1;E(v),O(r==null?void 0:r.total)}else console.error("Failed to fetch jobs:",r.message||"Unknown error")}catch(x){console.error("Error fetching job posts:",x)}finally{P(!1),console.log(S,"Total Count________")}},U=()=>{i>1&&m(s=>s-1)},B=()=>{i<y&&m(s=>s+1)},R=s=>{s.preventDefault(),m(1),j(1,D,n,l,t,c,h),C(D)},$=()=>{L(""),C(""),F(""),A(""),k(""),T(""),_("desc"),m(1),j(1,"","","","","","desc")},G=()=>{m(1),j(1,d,n,l,t,c,h)},I=s=>{m(1),k(s),j(1,d,n,l,s,c,h)},Q=s=>{let o="desc";c===s&&(o=h==="desc"?"asc":"desc"),T(s),_(o),m(1),j(1,d,n,l,t,s,o)},V=s=>c!==s?e.jsx("i",{className:"fas fa-sort text-muted ms-1"}):h==="desc"?e.jsx("i",{className:"fas fa-sort-down ms-1"}):e.jsx("i",{className:"fas fa-sort-up ms-1"});return e.jsx("div",{className:"page-wrapper",children:e.jsx("div",{className:"content",children:e.jsxs("div",{children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("h5",{className:"mb-0",children:["Job Post List Count - ",S]}),(d||n||l||t||c)&&e.jsxs("div",{className:"active-filters",children:[e.jsx("span",{className:"badge bg-light text-dark me-2",children:"Active Filters:"}),d&&e.jsxs("span",{className:"badge bg-info me-2",children:['Search: "',d,'"']}),n&&e.jsxs("span",{className:"badge bg-info me-2",children:["From: ",new Date(n).toLocaleDateString()]}),l&&e.jsxs("span",{className:"badge bg-info me-2",children:["To: ",new Date(l).toLocaleDateString()]}),t&&e.jsxs("span",{className:"badge bg-info me-2",children:["Payment: ",t==="paid"?"Paid":"Unpaid"]}),c&&e.jsxs("span",{className:"badge bg-primary me-2",children:["Sorted by: ",c==="applicants"?"Applicants":c," (",h==="desc"?"Highest First":"Lowest First",")"]}),e.jsxs("button",{className:"btn btn-sm btn-outline-danger",onClick:$,children:[e.jsx("i",{className:"fas fa-times me-1"}),"Clear All"]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("form",{onSubmit:R,className:"d-flex",children:[e.jsx("input",{type:"text",className:"form-control me-2",placeholder:"Search job title, company, business owner...",value:D,onChange:s=>L(s.target.value)}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-search me-1"}),"Search"]})]}),e.jsx("small",{className:"text-muted",children:"Search across job titles, descriptions, company names, or business owner details"})]}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"startDate",className:"form-label small",children:"Start Date"}),e.jsx("input",{type:"date",id:"startDate",className:"form-control",value:n,onChange:s=>F(s.target.value)})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",className:"form-label small",children:"End Date"}),e.jsx("input",{type:"date",id:"endDate",className:"form-control",value:l,onChange:s=>A(s.target.value)})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label small",children:"Payment Status"}),e.jsxs("div",{className:"btn-group w-100",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${t==="paid"?"btn-success":"btn-outline-success"}`,onClick:()=>I(t==="paid"?"":"paid"),children:"Paid"}),e.jsx("button",{type:"button",className:`btn btn-sm ${t==="unpaid"?"btn-warning":"btn-outline-warning"}`,onClick:()=>I(t==="unpaid"?"":"unpaid"),children:"Unpaid"})]})]})}),e.jsx("div",{className:"col-12 mt-2",children:e.jsxs("button",{className:"btn btn-secondary",onClick:G,disabled:!n&&!l,children:[e.jsx("i",{className:"fas fa-filter me-1"}),"Apply Date Filter"]})})]})})]})]})})}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("h4",{style:{textAlign:"center",fontWeight:"800",paddingTop:10,paddingBottom:25},children:["Job Post Total Count - ",S]}),w?e.jsxs("div",{className:"text-center my-4",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading job posts..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table border-0 comman-table datatable mb-0",style:{width:"100%",tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Address"}),e.jsx("th",{children:"Job Title"}),e.jsx("th",{children:"Business Owner"}),e.jsx("th",{children:"Phone Number"}),e.jsxs("th",{className:"cursor-pointer",onClick:()=>Q("applicants"),children:["Applicants ",V("applicants")]}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:p&&p.length>0?p.map((s,o)=>{var b,u,N,g,f,x,r,v;return e.jsxs("tr",{children:[e.jsx("td",{children:(i-1)*20+o+1}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((b=s==null?void 0:s.companyId)==null?void 0:b.companyLogo)||K,alt:"",height:40,width:40,style:{borderRadius:"50%",marginRight:"10px"}}),e.jsx("p",{className:"mb-0",children:((u=s==null?void 0:s.companyId)==null?void 0:u.companyName)||"N/A"})]})}),e.jsx("td",{children:e.jsx("p",{className:"mb-0",children:((N=s==null?void 0:s.branchData)==null?void 0:N.address)||"N/A"})}),e.jsx("td",{children:((g=s==null?void 0:s.jobTitle)==null?void 0:g.title)||"N/A"}),e.jsx("td",{children:((f=s==null?void 0:s.userId)==null?void 0:f.name)||"-"}),e.jsx("td",{children:((x=s==null?void 0:s.userId)==null?void 0:x.phoneNumber)||"-"}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-info",children:((v=(r=s==null?void 0:s.applicants)==null?void 0:r.applicants)==null?void 0:v.length)||0})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s!=null&&s.paymentDone?"bg-success":"bg-warning"}`,children:(s==null?void 0:s.paymentDone)===!0?"Paid":"Unpaid"})}),e.jsx("td",{children:s.createdAt?new Date(s.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}):"-"}),e.jsx("td",{children:e.jsx(H,{to:"/jobView",state:{post:s},className:"btn btn-sm btn-primary",children:"View"})})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:e.jsxs("div",{className:"py-4",children:[e.jsx("i",{className:"fas fa-file-search fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No job posts found"}),(d||n||l||t||c)&&e.jsx("p",{children:"Try adjusting your search criteria or clear filters"})]})})})})]})})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:U,disabled:i===1||w,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Previous"]}),e.jsxs("div",{className:"pagination-info",children:[e.jsxs("span",{className:"fw-bold",children:["Page ",i," of ",y]}),e.jsxs("div",{className:"text-muted small",children:["Showing ",p.length," of ",y*20," job posts"]})]}),e.jsxs("button",{className:"btn btn-secondary",onClick:B,disabled:i>=y||w,children:["Next ",e.jsx("i",{className:"fas fa-chevron-right ms-1"})]})]})]})})})};export{X as default};
