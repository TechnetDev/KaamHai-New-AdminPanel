import{r as n,j as e,L as G}from"./index-hO9sux4Y.js";import{p as H}from"./user-CZs_HDyx.js";import{i as K}from"./axiosInstance-BYKqn8JH.js";const W=async a=>{try{let t=`page=${a.page}`;return a.search&&(t+=`&search=${encodeURIComponent(a.search)}`),a.startDate&&(t+=`&startDate=${encodeURIComponent(a.startDate)}`),a.endDate&&(t+=`&endDate=${encodeURIComponent(a.endDate)}`),a.paymentStatus&&(t+=`&paymentStatus=${encodeURIComponent(a.paymentStatus)}`),a.sortBy&&(t+=`&sortBy=${encodeURIComponent(a.sortBy)}`),a.sortOrder&&(t+=`&sortOrder=${encodeURIComponent(a.sortOrder)}`),(await K.get(`admin/jobPostList?${t}`)).data}catch(t){return t.response?t.response.data:t.request?{success:!1,message:"No response received from server"}:{success:!1,message:t.message||"Error occurred while making the request"}}},X=()=>{const[a,t]=n.useState([]),[o,x]=n.useState(1),[v,R]=n.useState(1),[w,_]=n.useState(0),[D,P]=n.useState(!1),[m,F]=n.useState(""),[c,L]=n.useState(""),[l,A]=n.useState(""),[C,I]=n.useState(""),[r,k]=n.useState(""),[i,T]=n.useState(""),[j,$]=n.useState("desc");n.useEffect(()=>{b(o,m,c,l,r,i,j)},[o]);const b=async(s,h="",g="",N="",f="",p="",y="desc")=>{try{P(!0);const u={page:s,...h&&{search:h},...g&&{startDate:g},...N&&{endDate:N},...f&&{paymentStatus:f},...p&&{sortBy:p},...y&&{sortOrder:y}};console.log("Fetching with params:",u);const d=await W(u);if(d.success){t(d.data);const S=d.totalPages||1;R(S),_(d==null?void 0:d.total)}else console.error("Failed to fetch jobs:",d.message||"Unknown error")}catch(u){console.error("Error fetching job posts:",u)}finally{P(!1),console.log(w,"Total Count________")}},O=()=>{o>1&&x(s=>s-1)},E=()=>{o<v&&x(s=>s+1)},J=s=>{s.preventDefault(),x(1),b(1,C,c,l,r,i,j),F(C)},B=()=>{I(""),F(""),L(""),A(""),k(""),T(""),$("desc"),x(1),b(1,"","","","","","desc")},q=()=>{x(1),b(1,m,c,l,r,i,j)},U=s=>{x(1),k(s),b(1,m,c,l,s,i,j)},Q=s=>{let h="desc";i===s&&(h=j==="desc"?"asc":"desc"),T(s),$(h),x(1),b(1,m,c,l,r,s,h)},V=s=>i!==s?e.jsx("i",{className:"fas fa-sort text-muted ms-1"}):j==="desc"?e.jsx("i",{className:"fas fa-sort-down ms-1"}):e.jsx("i",{className:"fas fa-sort-up ms-1"});return e.jsx("div",{className:"page-wrapper",children:e.jsx("div",{className:"content",children:e.jsxs("div",{children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("h5",{className:"mb-0",children:["Job Post List Count - ",w]}),(m||c||l||r||i)&&e.jsxs("div",{className:"active-filters",children:[e.jsx("span",{className:"badge bg-light text-dark me-2",children:"Active Filters:"}),m&&e.jsxs("span",{className:"badge bg-info me-2",children:['Search: "',m,'"']}),c&&e.jsxs("span",{className:"badge bg-info me-2",children:["From: ",new Date(c).toLocaleDateString()]}),l&&e.jsxs("span",{className:"badge bg-info me-2",children:["To: ",new Date(l).toLocaleDateString()]}),r&&e.jsxs("span",{className:"badge bg-info me-2",children:["Payment: ",r==="paid"?"Paid":"Unpaid"]}),i&&e.jsxs("span",{className:"badge bg-primary me-2",children:["Sorted by: ",i==="applicants"?"Applicants":i," (",j==="desc"?"Highest First":"Lowest First",")"]}),e.jsxs("button",{className:"btn btn-sm btn-outline-danger",onClick:B,children:[e.jsx("i",{className:"fas fa-times me-1"}),"Clear All"]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("form",{onSubmit:J,className:"d-flex",children:[e.jsx("input",{type:"text",className:"form-control me-2",placeholder:"Search job title, company, business owner...",value:C,onChange:s=>I(s.target.value)}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-search me-1"}),"Search"]})]}),e.jsx("small",{className:"text-muted",children:"Search across job titles, descriptions, company names, or business owner details"})]}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"startDate",className:"form-label small",children:"Start Date"}),e.jsx("input",{type:"date",id:"startDate",className:"form-control",value:c,onChange:s=>L(s.target.value)})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",className:"form-label small",children:"End Date"}),e.jsx("input",{type:"date",id:"endDate",className:"form-control",value:l,onChange:s=>A(s.target.value)})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label small",children:"Payment Status"}),e.jsxs("div",{className:"btn-group w-100",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${r==="paid"?"btn-success":"btn-outline-success"}`,onClick:()=>U(r==="paid"?"":"paid"),children:"Paid"}),e.jsx("button",{type:"button",className:`btn btn-sm ${r==="unpaid"?"btn-warning":"btn-outline-warning"}`,onClick:()=>U(r==="unpaid"?"":"unpaid"),children:"Unpaid"})]})]})}),e.jsx("div",{className:"col-12 mt-2",children:e.jsxs("button",{className:"btn btn-secondary",onClick:q,disabled:!c&&!l,children:[e.jsx("i",{className:"fas fa-filter me-1"}),"Apply Date Filter"]})})]})})]})]})})}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("h4",{style:{textAlign:"center",fontWeight:"800",paddingTop:10,paddingBottom:25},children:["Job Post Total Count - ",w]}),D?e.jsxs("div",{className:"text-center my-4",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading job posts..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table border-0 comman-table datatable mb-0",style:{width:"100%",tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Address"}),e.jsx("th",{children:"Job Title"}),e.jsx("th",{children:"Business Owner"}),e.jsx("th",{children:"Phone Number"}),e.jsxs("th",{className:"cursor-pointer",onClick:()=>Q("applicants"),children:["Applicants ",V("applicants")]}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:a&&a.length>0?a.map((s,h)=>{var g,N,f,p,y,u,d,S;return e.jsxs("tr",{children:[e.jsx("td",{children:(o-1)*20+h+1}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((g=s==null?void 0:s.companyId)==null?void 0:g.companyLogo)||H,alt:"",height:40,width:40,style:{borderRadius:"50%",marginRight:"10px"}}),e.jsx("p",{className:"mb-0",children:((N=s==null?void 0:s.companyId)==null?void 0:N.companyName)||"N/A"})]})}),e.jsx("td",{children:e.jsx("p",{className:"mb-0",children:((f=s==null?void 0:s.branchData)==null?void 0:f.address)||"N/A"})}),e.jsx("td",{children:((p=s==null?void 0:s.jobTitle)==null?void 0:p.title)||"N/A"}),e.jsx("td",{children:((y=s==null?void 0:s.userId)==null?void 0:y.name)||"-"}),e.jsx("td",{children:((u=s==null?void 0:s.userId)==null?void 0:u.phoneNumber)||"-"}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-info",children:((S=(d=s==null?void 0:s.applicants)==null?void 0:d.applicants)==null?void 0:S.length)||0})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s!=null&&s.paymentDone?"bg-success":"bg-warning"}`,children:(s==null?void 0:s.paymentDone)===!0?"Paid":"Unpaid"})}),e.jsx("td",{children:s.createdAt?new Date(s.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}):"-"}),e.jsx("td",{children:e.jsx(G,{to:"/jobView",state:{post:s},className:"btn btn-sm btn-primary",children:"View"})})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:e.jsxs("div",{className:"py-4",children:[e.jsx("i",{className:"fas fa-file-search fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No job posts found"}),(m||c||l||r||i)&&e.jsx("p",{children:"Try adjusting your search criteria or clear filters"})]})})})})]})})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:O,disabled:o===1||D,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Previous"]}),e.jsxs("div",{className:"pagination-info",children:[e.jsxs("span",{className:"fw-bold",children:["Page ",o," of ",v]}),e.jsxs("div",{className:"text-muted small",children:["Showing ",a.length," of ",v*20," job posts"]})]}),e.jsxs("button",{className:"btn btn-secondary",onClick:E,disabled:o>=v||D,children:["Next ",e.jsx("i",{className:"fas fa-chevron-right ms-1"})]})]})]})})})};export{X as default};
