import{r as a,j as e,L as M}from"./index-PZFsZQKU.js";import{a as X}from"./users-CG-DLpz1.js";import{p as Y}from"./user-CVMOkeQd.js";import ee from"./B2CView-C6iqxKtp.js";import"./axiosInstance-Bmncee0s.js";const ne=()=>{const[b,V]=a.useState([]),[r,o]=a.useState(1),[N,J]=a.useState(1),[g,C]=a.useState(!1),[S,D]=a.useState(!0),[k,A]=a.useState(!1),[R,I]=a.useState(),[d,P]=a.useState(""),[l,F]=a.useState(""),[i,L]=a.useState(""),[v,E]=a.useState(""),[t,T]=a.useState("all"),[n,U]=a.useState("all"),[c,Q]=a.useState("all"),[G,K]=a.useState(0);a.useEffect(()=>{m(r,d,l,i,t,n,c)},[r]);const m=async(s,p="",h="",x="",f="all",B="all",$="all")=>{try{C(!0);const w={page:s,...p&&{search:p},...h&&{startDate:h},...x&&{endDate:x},...f!=="all"&&{aadharVerified:f==="verified"},...B!=="all"&&{profileVerified:B==="verified"},...$!=="all"&&{appliedJobs:$==="applied"}},j=await X(w);if(j.success){V(j.data);const H=j.totalPages||1;J(H),K(j.total)}else console.error("Failed to fetch users:",j.message||"Unknown error")}catch(w){console.error("Error fetching B2C users:",w)}finally{C(!1)}},O=()=>{r>1&&o(s=>s-1)},W=()=>{r<N&&o(s=>s+1)},Z=s=>{s.preventDefault(),o(1),m(1,v,l,i,t,n,c),P(v)},_=()=>{E(""),P(""),F(""),L(""),T("all"),U("all"),Q("all"),o(1),m(1,"","","","all","all","all")},q=()=>{o(1),m(1,d,l,i,t,n,c)},u=s=>{T(s),o(1),m(1,d,l,i,s,n,c)},y=s=>{U(s),o(1),m(1,d,l,i,t,s,c)},z=s=>{I(s),D(!1),A(!0)};return e.jsxs(e.Fragment,{children:[S&&!k&&e.jsx("div",{className:"page-wrapper",children:e.jsx("div",{className:"content",children:e.jsxs("div",{children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h5",{className:"mb-0",children:"B2C Users List"}),(d||l||i||t!=="all"||n!=="all"||c!=="all")&&e.jsxs("div",{className:"active-filters",children:[e.jsx("span",{className:"badge bg-light text-dark me-2",children:"Active Filters:"}),d&&e.jsxs("span",{className:"badge bg-info me-2",children:['Search: "',d,'"']}),l&&e.jsxs("span",{className:"badge bg-info me-2",children:["From: ",new Date(l).toLocaleDateString()]}),i&&e.jsxs("span",{className:"badge bg-info me-2",children:["To: ",new Date(i).toLocaleDateString()]}),t!=="all"&&e.jsxs("span",{className:"badge bg-info me-2",children:["Aadhar: ",t==="verified"?"Verified":"Not Verified"]}),n!=="all"&&e.jsxs("span",{className:"badge bg-info me-2",children:["Profile: ",n==="verified"?"Verified":"Not Verified"]}),c!=="all"&&e.jsxs("span",{className:"badge bg-info me-2",children:["Applications: ",c==="applied"?"Applied":"Not Applied"]}),e.jsxs("button",{className:"btn btn-sm btn-outline-danger",onClick:_,children:[e.jsx("i",{className:"fas fa-times me-1"}),"Clear All"]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("form",{onSubmit:Z,className:"d-flex",children:[e.jsx("input",{type:"text",className:"form-control me-2",placeholder:"Search by name, phone number, city...",value:v,onChange:s=>E(s.target.value)}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-search me-1"}),"Search"]})]}),e.jsx("small",{className:"text-muted",children:"Search by name, phone number, father's name, or contact information"})]}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"startDate",className:"form-label small",children:"Registration From"}),e.jsx("input",{type:"date",id:"startDate",className:"form-control",value:l,onChange:s=>F(s.target.value)})]})}),e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",className:"form-label small",children:"Registration To"}),e.jsx("input",{type:"date",id:"endDate",className:"form-control",value:i,onChange:s=>L(s.target.value)})]})}),e.jsx("div",{className:"col-md-2 d-flex align-items-end",children:e.jsx("button",{className:"btn btn-secondary w-100",onClick:q,disabled:!l&&!i,children:e.jsx("i",{className:"fas fa-filter"})})})]})})]}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card bg-light",children:e.jsx("div",{className:"card-body py-2",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-3",children:e.jsx("span",{className:"fw-medium",children:"Aadhar Status:"})}),e.jsx("div",{className:"col-md-9",children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx("button",{type:"button",className:`btn ${t==="all"?"btn-primary":"btn-outline-primary"}`,onClick:()=>u("all"),children:"All Users"}),e.jsxs("button",{type:"button",className:`btn ${t==="verified"?"btn-primary":"btn-outline-primary"}`,onClick:()=>u("verified"),children:[e.jsx("i",{className:"fas fa-check-circle me-1"}),"Aadhar Verified"]}),e.jsxs("button",{type:"button",className:`btn ${t==="notVerified"?"btn-primary":"btn-outline-primary"}`,onClick:()=>u("notVerified"),children:[e.jsx("i",{className:"fas fa-times-circle me-1"}),"Aadhar Not Verified"]})]})})]})})})})}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card bg-light",children:e.jsx("div",{className:"card-body py-2",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-3",children:e.jsx("span",{className:"fw-medium",children:"Profile Status:"})}),e.jsx("div",{className:"col-md-9",children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx("button",{type:"button",className:`btn ${n==="all"?"btn-warning":"btn-outline-warning"}`,onClick:()=>y("all"),children:"All Users"}),e.jsxs("button",{type:"button",className:`btn ${n==="verified"?"btn-warning":"btn-outline-warning"}`,onClick:()=>y("verified"),children:[e.jsx("i",{className:"fas fa-user-check me-1"}),"Profile Verified"]}),e.jsxs("button",{type:"button",className:`btn ${n==="notVerified"?"btn-warning":"btn-outline-warning"}`,onClick:()=>y("notVerified"),children:[e.jsx("i",{className:"fas fa-user-times me-1"}),"Profile Not Verified"]})]})})]})})})})})]})})}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("h4",{style:{textAlign:"center",fontWeight:"800",paddingTop:10,paddingBottom:25},children:["Total Count - ",G]}),g?e.jsxs("div",{className:"text-center my-4",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading users..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table border-0 custom-table comman-table datatable mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Photo"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Phone Number"}),e.jsx("th",{children:"Registration Date"}),e.jsx("th",{children:"Aadhar Verified"}),e.jsx("th",{children:"Profile Verified"}),e.jsx("th",{children:"Current Employee"}),e.jsx("th",{children:"Applied Jobs"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:b.length>0?b.map((s,p)=>{var h,x,f;return e.jsxs("tr",{children:[e.jsx("td",{children:(r-1)*20+p+1}),e.jsx("td",{children:e.jsx("img",{src:(s==null?void 0:s.profile)||Y,alt:"",height:50,width:50,style:{borderRadius:"50%",objectFit:"cover"}})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("span",{className:"fw-bold text-dark",children:((h=s==null?void 0:s.basicDetails)==null?void 0:h.name)||"-"}),((x=s==null?void 0:s.basicDetails)==null?void 0:x.city)&&e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-map-marker-alt me-1"}),s.basicDetails.city]})]})}),e.jsx("td",{children:s.phoneNumber||"-"}),e.jsx("td",{children:s.createdAt?new Date(s.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}):"-"}),e.jsx("td",{children:s!=null&&s.isAadharphotoVerified&&(s!=null&&s.isDocumentVerified)||s!=null&&s.isAadharOtpVerfied?e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-check-circle me-1"})," Verified"]}):e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-times-circle me-1"})," Not Verified"]})}),e.jsx("td",{children:s!=null&&s.isPhotoVerified?e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-check-circle me-1"})," Verified"]}):e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-times-circle me-1"})," Not Verified"]})}),e.jsx("td",{children:s!=null&&s.isCurrentEmployee?e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"fas fa-check-circle me-1"})," Current Employee"]}):e.jsxs("span",{className:"badge bg-warning",children:[e.jsx("i",{className:"fas fa-times-circle me-1"})," New Employee"]})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-info",children:((f=s==null?void 0:s.appliedJobs)==null?void 0:f.length)||0})}),e.jsx("td",{onClick:()=>z(s),children:e.jsxs(M,{state:{user:s},className:"btn btn-sm btn-primary",children:[e.jsx("i",{className:"fas fa-eye me-1"})," View"]})})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:e.jsxs("div",{className:"py-4",children:[e.jsx("i",{className:"fas fa-user-slash fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No users found"}),(d||l||i||t!=="all"||n!=="all"||c!=="all")&&e.jsx("p",{children:"Try adjusting your search criteria or clear filters"})]})})})})]})})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:O,disabled:r===1||g,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Previous"]}),e.jsxs("div",{className:"pagination-info",children:[e.jsxs("span",{className:"fw-bold",children:["Page ",r," of ",N]}),e.jsxs("div",{className:"text-muted small",children:["Showing ",b.length," of ",N*20," users"]})]}),e.jsxs("button",{className:"btn btn-secondary",onClick:W,disabled:r>=N||g,children:["Next ",e.jsx("i",{className:"fas fa-chevron-right ms-1"})]})]})]})})}),k&&!S&&e.jsx(ee,{user:R,setListPage:D,setViewPage:A,users:b,setUsers:V})]})};export{ne as default};
