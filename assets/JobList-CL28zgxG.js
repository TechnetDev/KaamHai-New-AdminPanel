import{r as a,j as e,L as X}from"./index-BUfdoEYc.js";import{a as Y,p as ee}from"./user-De0equEN.js";import se from"./JobPostView-Clphjin1.js";import"./axiosInstance-C4mAaFYM.js";const ce=()=>{const[p,O]=a.useState([]),[r,m]=a.useState(1),[y,U]=a.useState(1),[S,V]=a.useState(0),[w,D]=a.useState(!1),[B,C]=a.useState(!0),[R,F]=a.useState(!1),[$,Q]=a.useState(),[d,L]=a.useState(""),[n,A]=a.useState(""),[l,k]=a.useState(""),[P,T]=a.useState(""),[t,_]=a.useState(""),[c,J]=a.useState(""),[h,I]=a.useState("desc");a.useEffect(()=>{j(r,d,n,l,t,c,h)},[r]);const j=async(s,o="",b="",u="",g="",N="",f="desc")=>{try{D(!0);const x={page:s,...o&&{search:o},...b&&{startDate:b},...u&&{endDate:u},...g&&{paymentStatus:g},...N&&{sortBy:N},...f&&{sortOrder:f}};console.log("Fetching with params:",x);const i=await Y(x);if(i.success){O(i.data);const v=i.totalPages||1;U(v),V(i==null?void 0:i.total)}else console.error("Failed to fetch jobs:",i.message||"Unknown error")}catch(x){console.error("Error fetching job posts:",x)}finally{D(!1),console.log(S,"Total Count________")}},G=()=>{r>1&&m(s=>s-1)},H=()=>{r<y&&m(s=>s+1)},K=s=>{s.preventDefault(),m(1),j(1,P,n,l,t,c,h),L(P)},W=()=>{T(""),L(""),A(""),k(""),_(""),J(""),I("desc"),m(1),j(1,"","","","","","desc")},Z=()=>{m(1),j(1,d,n,l,t,c,h)},E=s=>{m(1),_(s),j(1,d,n,l,s,c,h)},q=s=>{let o="desc";c===s&&(o=h==="desc"?"asc":"desc"),J(s),I(o),m(1),j(1,d,n,l,t,s,o)},z=s=>c!==s?e.jsx("i",{className:"fas fa-sort text-muted ms-1"}):h==="desc"?e.jsx("i",{className:"fas fa-sort-down ms-1"}):e.jsx("i",{className:"fas fa-sort-up ms-1"}),M=s=>{F(!0),C(!1),Q(s)};return e.jsxs(e.Fragment,{children:[B&&e.jsx("div",{className:"page-wrapper",children:e.jsx("div",{className:"content",children:e.jsxs("div",{children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("h5",{className:"mb-0",children:["Job Post List Count - ",S]}),(d||n||l||t||c)&&e.jsxs("div",{className:"active-filters",children:[e.jsx("span",{className:"badge bg-light text-dark me-2",children:"Active Filters:"}),d&&e.jsxs("span",{className:"badge bg-info me-2",children:['Search: "',d,'"']}),n&&e.jsxs("span",{className:"badge bg-info me-2",children:["From: ",new Date(n).toLocaleDateString()]}),l&&e.jsxs("span",{className:"badge bg-info me-2",children:["To: ",new Date(l).toLocaleDateString()]}),t&&e.jsxs("span",{className:"badge bg-info me-2",children:["Payment: ",t==="paid"?"Paid":"Unpaid"]}),c&&e.jsxs("span",{className:"badge bg-primary me-2",children:["Sorted by: ",c==="applicants"?"Applicants":c," (",h==="desc"?"Highest First":"Lowest First",")"]}),e.jsxs("button",{className:"btn btn-sm btn-outline-danger",onClick:W,children:[e.jsx("i",{className:"fas fa-times me-1"}),"Clear All"]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("form",{onSubmit:K,className:"d-flex",children:[e.jsx("input",{type:"text",className:"form-control me-2",placeholder:"Search job title, company, business owner...",value:P,onChange:s=>T(s.target.value)}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-search me-1"}),"Search"]})]}),e.jsx("small",{className:"text-muted",children:"Search across job titles, descriptions, company names, or business owner details"})]}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"startDate",className:"form-label small",children:"Start Date"}),e.jsx("input",{type:"date",id:"startDate",className:"form-control",value:n,onChange:s=>A(s.target.value)})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",className:"form-label small",children:"End Date"}),e.jsx("input",{type:"date",id:"endDate",className:"form-control",value:l,onChange:s=>k(s.target.value)})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label small",children:"Payment Status"}),e.jsxs("div",{className:"btn-group w-100",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${t==="paid"?"btn-success":"btn-outline-success"}`,onClick:()=>E(t==="paid"?"":"paid"),children:"Paid"}),e.jsx("button",{type:"button",className:`btn btn-sm ${t==="unpaid"?"btn-warning":"btn-outline-warning"}`,onClick:()=>E(t==="unpaid"?"":"unpaid"),children:"Unpaid"})]})]})}),e.jsx("div",{className:"col-12 mt-2",children:e.jsxs("button",{className:"btn btn-secondary",onClick:Z,disabled:!n&&!l,children:[e.jsx("i",{className:"fas fa-filter me-1"}),"Apply Date Filter"]})})]})})]})]})})}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("h4",{style:{textAlign:"center",fontWeight:"800",paddingTop:10,paddingBottom:25},children:["Job Post Total Count - ",S]}),w?e.jsxs("div",{className:"text-center my-4",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading job posts..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table border-0 comman-table datatable mb-0",style:{width:"100%",tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Address"}),e.jsx("th",{children:"Job Title"}),e.jsx("th",{children:"Business Owner"}),e.jsx("th",{children:"Phone Number"}),e.jsxs("th",{className:"cursor-pointer",onClick:()=>q("applicants"),children:["Applicants ",z("applicants")]}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:p&&p.length>0?p.map((s,o)=>{var b,u,g,N,f,x,i,v;return e.jsxs("tr",{children:[e.jsx("td",{children:(r-1)*20+o+1}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((b=s==null?void 0:s.companyId)==null?void 0:b.companyLogo)||ee,alt:"",height:40,width:40,style:{borderRadius:"50%",marginRight:"10px"}}),e.jsx("p",{className:"mb-0",children:((u=s==null?void 0:s.companyId)==null?void 0:u.companyName)||"N/A"})]})}),e.jsx("td",{children:e.jsx("p",{className:"mb-0",children:((g=s==null?void 0:s.branchData)==null?void 0:g.address)||"N/A"})}),e.jsx("td",{children:((N=s==null?void 0:s.jobTitle)==null?void 0:N.title)||"N/A"}),e.jsx("td",{children:((f=s==null?void 0:s.userId)==null?void 0:f.name)||"-"}),e.jsx("td",{children:((x=s==null?void 0:s.userId)==null?void 0:x.phoneNumber)||"-"}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-info",children:((v=(i=s==null?void 0:s.applicants)==null?void 0:i.applicants)==null?void 0:v.length)||0})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s!=null&&s.paymentDone?"bg-success":"bg-warning"}`,children:(s==null?void 0:s.paymentDone)===!0?"Paid":"Unpaid"})}),e.jsx("td",{children:s.createdAt?new Date(s.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}):"-"}),e.jsx("td",{children:e.jsx(X,{onClick:()=>M(s),state:{post:s},className:"btn btn-sm btn-primary",children:"View"})})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:e.jsxs("div",{className:"py-4",children:[e.jsx("i",{className:"fas fa-file-search fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No job posts found"}),(d||n||l||t||c)&&e.jsx("p",{children:"Try adjusting your search criteria or clear filters"})]})})})})]})})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:G,disabled:r===1||w,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Previous"]}),e.jsxs("div",{className:"pagination-info",children:[e.jsxs("span",{className:"fw-bold",children:["Page ",r," of ",y]}),e.jsxs("div",{className:"text-muted small",children:["Showing ",p.length," of ",y*20," job posts"]})]}),e.jsxs("button",{className:"btn btn-secondary",onClick:H,disabled:r>=y||w,children:["Next ",e.jsx("i",{className:"fas fa-chevron-right ms-1"})]})]})]})})}),R&&e.jsx(se,{post:$,setListPage:C,setViewPage:F})]})};export{ce as default};
