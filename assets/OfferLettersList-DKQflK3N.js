import{r as t,B as u,j as e,O as te}from"./index-B9EhzTRJ.js";import{G as ne,p as ce,U as ie}from"./user-MtZiRSs5.js";const me=()=>{const[N,U]=t.useState([]),[h,p]=t.useState(1),[g,V]=t.useState(1),[S,q]=t.useState(0),[G,T]=t.useState(!1),[K,Q]=t.useState(),[W,C]=t.useState(!0),[Y,A]=t.useState(!1),[z,v]=t.useState(!1),[y,L]=t.useState(!1),[a,j]=t.useState({_id:"",title:"",phoneNumber:"",jobDescription:"",jobType:"",employmentType:"",salaryType:"",salary:"",allowances:[],startDate:"",endDate:"",statusEmployee:"",statusEmployer:""}),[w,D]=t.useState(""),[E,k]=t.useState(""),[x,P]=t.useState(""),[d,O]=t.useState(""),[r,R]=t.useState(""),Z=s=>{Q(s),A(!0),C(!1)},$=s=>{var l,n,c,m;j({_id:s._id,title:((l=s==null?void 0:s.jobTitleData)==null?void 0:l.title)||"",phoneNumber:((n=s==null?void 0:s.employeeData)==null?void 0:n.phoneNumber)||"",jobDescription:(s==null?void 0:s.jobDescription)||"",jobType:(s==null?void 0:s.jobType)||"",employmentType:(s==null?void 0:s.employmentType)||"",salaryType:(s==null?void 0:s.salaryType)||"",salary:(s==null?void 0:s.salary)||"",allowances:(s==null?void 0:s.allowances)||[],startDate:s!=null&&s.startDate?s.startDate.split("T")[0]:"",endDate:s!=null&&s.endDate?s.endDate.split("T")[0]:"",statusEmployee:((c=s==null?void 0:s.status)==null?void 0:c.employee)||"Active",statusEmployer:((m=s==null?void 0:s.status)==null?void 0:m.employer)||"offerToBeSend"}),v(!0)},i=s=>{const{name:l,value:n}=s.target;j(c=>({...c,[l]:n}))},F=()=>{w.trim()&&(j(s=>({...s,allowances:[...s.allowances,w.trim()]})),D(""))},X=s=>{j(l=>({...l,allowances:l.allowances.filter((n,c)=>c!==s)}))},f=async s=>{s.preventDefault();try{L(!0);const l={title:a.title,phoneNumber:a.phoneNumber,jobDescription:a.jobDescription,jobType:a.jobType,employmentType:a.employmentType,salaryType:a.salaryType,salary:a.salary,allowances:a.allowances,startDate:a.startDate,endDate:a.endDate,status:{employee:a.statusEmployee,employer:a.statusEmployer}},n=await ie(a._id,l);n.success?(u.success(n.title||"Offer letter updated successfully!"),v(!1),b(h,x,d,r)):u.error(n.message||"Failed to update offer letter")}catch(l){u.error(l.message||"Something went wrong")}finally{L(!1)}},I=()=>{v(!1),D(""),j({_id:"",title:"",phoneNumber:"",jobDescription:"",jobType:"",employmentType:"",salaryType:"",salary:"",allowances:[],startDate:"",endDate:"",statusEmployee:"",statusEmployer:""})};t.useEffect(()=>{b(h,x,d,r)},[h]);const b=async(s,l="",n="",c="")=>{try{T(!0);const m={page:s,...l&&{search:l},...n&&{startDate:n},...c&&{endDate:c}},o=await ne(m);o.success?(U(o.data),V(o.totalPages||1),q(o.total||0)):u.error(o.message||"Failed to fetch offer letters")}catch(m){u.error(m.message||"Something went wrong")}finally{T(!1)}},ee=s=>{s.preventDefault(),p(1),P(E),b(1,E,d,r)},se=()=>{k(""),P(""),O(""),R(""),p(1),b(1,"","","")},ae=()=>{p(1),b(1,x,d,r)},le=s=>({offerToBeSend:"bg-secondary",awaitingResponse:"bg-warning",offerAccepted:"bg-success",offerRejected:"bg-danger",offerExpired:"bg-dark",exEmployee:"bg-info"})[s]||"bg-secondary";return e.jsxs(e.Fragment,{children:[W&&e.jsx("div",{className:"page-wrapper",children:e.jsx("div",{className:"content",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("h5",{className:"mb-0",children:["Offer Letter Count - ",S]}),(x||d||r)&&e.jsxs("div",{className:"active-filters",children:[e.jsx("span",{className:"badge bg-light text-dark me-2",children:"Active Filters:"}),x&&e.jsxs("span",{className:"badge bg-info me-2",children:['Search: "',x,'"']}),d&&e.jsxs("span",{className:"badge bg-info me-2",children:["From: ",new Date(d).toLocaleDateString()]}),r&&e.jsxs("span",{className:"badge bg-info me-2",children:["To: ",new Date(r).toLocaleDateString()]}),e.jsxs("button",{className:"btn btn-sm btn-outline-danger",onClick:se,children:[e.jsx("i",{className:"fas fa-times me-1"})," Clear All"]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("form",{onSubmit:ee,className:"d-flex",children:[e.jsx("input",{type:"text",className:"form-control me-2",placeholder:"Search by candidate or company...",value:E,onChange:s=>k(s.target.value)}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-search me-1"})," Search"]})]})}),e.jsxs("div",{className:"col-md-6 d-flex",children:[e.jsxs("div",{className:"me-2",children:[e.jsx("label",{className:"form-label small",children:"Start Date"}),e.jsx("input",{type:"date",className:"form-control",value:d,onChange:s=>O(s.target.value)})]}),e.jsxs("div",{className:"me-2",children:[e.jsx("label",{className:"form-label small",children:"End Date"}),e.jsx("input",{type:"date",className:"form-control",value:r,onChange:s=>R(s.target.value)})]}),e.jsx("div",{className:"align-self-end",children:e.jsxs("button",{className:"btn btn-secondary",onClick:ae,disabled:!d&&!r,children:[e.jsx("i",{className:"fas fa-filter me-1"})," Apply"]})})]})]}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("h4",{style:{textAlign:"center",fontWeight:"800",paddingTop:10,paddingBottom:25},children:["Offer Letter Total Count - ",S]}),G?e.jsxs("div",{className:"text-center my-4",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading offer letters..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table border-0 comman-table datatable mb-0",style:{width:"100%",tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Branch Address"}),e.jsx("th",{children:"Job Title"}),e.jsx("th",{children:"Employee Name"}),e.jsx("th",{children:"Phone Number"}),e.jsx("th",{children:"Salary"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Issued At"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:N&&N.length>0?N.map((s,l)=>{var n,c,m,o,B,_,M,J,H;return e.jsxs("tr",{children:[e.jsx("td",{children:(h-1)*20+l+1}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((n=s==null?void 0:s.companyData)==null?void 0:n.companyLogo)||ce,alt:"",height:40,width:40,style:{borderRadius:"50%",marginRight:"10px"}}),e.jsx("p",{className:"mb-0",children:((c=s==null?void 0:s.companyData)==null?void 0:c.companyName)||"N/A"})]})}),e.jsx("td",{children:e.jsx("p",{className:"mb-0",children:((m=s==null?void 0:s.branchData)==null?void 0:m.address)||"N/A"})}),e.jsx("td",{children:((o=s==null?void 0:s.jobTitleData)==null?void 0:o.title)||"N/A"}),e.jsx("td",{children:((_=(B=s==null?void 0:s.employeeData)==null?void 0:B.basicDetails)==null?void 0:_.name)||"-"}),e.jsx("td",{children:((M=s==null?void 0:s.employeeData)==null?void 0:M.phoneNumber)||"-"}),e.jsx("td",{children:(s==null?void 0:s.salary)||"-"}),e.jsx("td",{children:e.jsx("div",{className:"d-flex flex-column gap-1",children:e.jsx("span",{className:`badge ${le((J=s==null?void 0:s.status)==null?void 0:J.employer)}`,children:((H=s==null?void 0:s.status)==null?void 0:H.employer)||"Pending"})})}),e.jsx("td",{children:s!=null&&s.createdAt?new Date(s==null?void 0:s.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):"-"}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-primary btn-sm text-white px-2",onClick:()=>Z(s),title:"View",children:e.jsx("i",{className:"fas fa-eye"})}),e.jsx("button",{className:"btn btn-warning btn-sm text-white px-2",onClick:()=>$(s),title:"Edit",children:e.jsx("i",{className:"fas fa-edit"})})]})})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:e.jsxs("div",{className:"py-4",children:[e.jsx("i",{className:"fas fa-file-alt fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No offer letters found"}),(x||d||r)&&e.jsx("p",{children:"Try adjusting your search criteria or clear filters"})]})})})})]})})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>p(s=>Math.max(1,s-1)),disabled:h===1,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Previous"]}),e.jsxs("span",{className:"fw-bold",children:["Page ",h," of ",g]}),e.jsxs("button",{className:"btn btn-secondary",onClick:()=>p(s=>Math.min(g,s+1)),disabled:h===g,children:["Next ",e.jsx("i",{className:"fas fa-chevron-right ms-1"})]})]})]})})})})}),Y&&e.jsx(te,{offer:K,viewPage:A,listPage:C}),z&&e.jsx("div",{className:"modal fade show d-block",style:{backgroundColor:"rgba(0,0,0,0.5)"},tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-primary text-white",children:[e.jsxs("h5",{className:"modal-title",children:[e.jsx("i",{className:"fas fa-edit me-2"}),"Edit Offer Letter"]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:I,disabled:y})]}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"modal-body",style:{maxHeight:"70vh",overflowY:"auto"},children:[e.jsxs("div",{className:"card mb-3",children:[e.jsx("div",{className:"card-header bg-light",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-info-circle me-2"}),"Basic Information"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsxs("label",{className:"form-label",children:["Job Title ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:"form-control",name:"title",value:a.title,onChange:i,placeholder:"Enter job title",required:!0}),e.jsx("small",{className:"text-muted",children:"Title will be matched or created in the system"})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsxs("label",{className:"form-label",children:["Employee Phone Number ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"tel",className:"form-control",name:"phoneNumber",value:a.phoneNumber,onChange:i,placeholder:"Enter phone number",required:!0}),e.jsx("small",{className:"text-muted",children:"If changed, employee will be updated accordingly"})]}),e.jsxs("div",{className:"col-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Job Description"}),e.jsx("textarea",{className:"form-control",name:"jobDescription",value:a.jobDescription,onChange:i,rows:"3",placeholder:"Enter job description"})]})]})})]}),e.jsxs("div",{className:"card mb-3",children:[e.jsx("div",{className:"card-header bg-light",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-briefcase me-2"}),"Employment Details"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"form-label",children:"Job Type"}),e.jsxs("select",{className:"form-select",name:"jobType",value:a.jobType,onChange:i,children:[e.jsx("option",{value:"",children:"Select Job Type"}),e.jsx("option",{value:"onsite",children:"Onsite"}),e.jsx("option",{value:"remote",children:"Remote"}),e.jsx("option",{value:"hybrid",children:"Hybrid"})]})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"form-label",children:"Employment Type"}),e.jsxs("select",{className:"form-select",name:"employmentType",value:a.employmentType,onChange:i,children:[e.jsx("option",{value:"",children:"Select Employment Type"}),e.jsx("option",{value:"full-time",children:"Full Time"}),e.jsx("option",{value:"part-time",children:"Part Time"}),e.jsx("option",{value:"contract",children:"Contract"}),e.jsx("option",{value:"internship",children:"Internship"}),e.jsx("option",{value:"freelance",children:"Freelance"}),e.jsx("option",{value:"temporary",children:"Temporary"})]})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"form-label",children:"Start Date"}),e.jsx("input",{type:"date",className:"form-control",name:"startDate",value:a.startDate,onChange:i})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"form-label",children:"End Date"}),e.jsx("input",{type:"date",className:"form-control",name:"endDate",value:a.endDate,onChange:i}),e.jsx("small",{className:"text-muted",children:"Leave empty for permanent positions"})]})]})})]}),e.jsxs("div",{className:"card mb-3",children:[e.jsx("div",{className:"card-header bg-light",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-money-bill-wave me-2"}),"Compensation"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"form-label",children:"Salary Type"}),e.jsxs("select",{className:"form-select",name:"salaryType",value:a.salaryType,onChange:i,children:[e.jsx("option",{value:"",children:"Select Salary Type"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"hourly",children:"Hourly"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"fixed",children:"Fixed"})]})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"form-label",children:"Salary"}),e.jsx("input",{type:"text",className:"form-control",name:"salary",value:a.salary,onChange:i,placeholder:"Enter salary (e.g., â‚¹50,000)"})]}),e.jsxs("div",{className:"col-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Allowances"}),e.jsxs("div",{className:"input-group mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:w,onChange:s=>D(s.target.value),placeholder:"Enter allowance (e.g., HRA, Travel, Food)",onKeyPress:s=>{s.key==="Enter"&&(s.preventDefault(),F())}}),e.jsxs("button",{type:"button",className:"btn btn-outline-primary",onClick:F,children:[e.jsx("i",{className:"fas fa-plus"})," Add"]})]}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:a.allowances.map((s,l)=>e.jsxs("span",{className:"badge bg-info d-flex align-items-center gap-2 py-2 px-3",children:[s,e.jsx("button",{type:"button",className:"btn-close btn-close-white btn-sm",onClick:()=>X(l),style:{fontSize:"0.6rem"}})]},l))}),a.allowances.length===0&&e.jsx("small",{className:"text-muted",children:"No allowances added yet"})]})]})})]}),e.jsxs("div",{className:"card mb-3",children:[e.jsx("div",{className:"card-header bg-light",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-tasks me-2"}),"Status"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"form-label",children:"Employee Status"}),e.jsxs("select",{className:"form-select",name:"statusEmployee",value:a.statusEmployee,onChange:i,children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Accepted",children:"Accepted"}),e.jsx("option",{value:"Rejected",children:"Rejected"}),e.jsx("option",{value:"Expired",children:"Expired"}),e.jsx("option",{value:"exEmployee",children:"Ex-Employee"})]})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"form-label",children:"Employer Status"}),e.jsxs("select",{className:"form-select",name:"statusEmployer",value:a.statusEmployer,onChange:i,children:[e.jsx("option",{value:"offerToBeSend",children:"Offer To Be Send"}),e.jsx("option",{value:"awaitingResponse",children:"Awaiting Response"}),e.jsx("option",{value:"offerAccepted",children:"Offer Accepted"}),e.jsx("option",{value:"offerRejected",children:"Offer Rejected"}),e.jsx("option",{value:"offerExpired",children:"Offer Expired"}),e.jsx("option",{value:"exEmployee",children:"Ex-Employee"})]})]})]})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:I,disabled:y,children:[e.jsx("i",{className:"fas fa-times me-1"})," Cancel"]}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save me-1"})," Update Offer Letter"]})})]})]})]})})})]})};export{me as default};
