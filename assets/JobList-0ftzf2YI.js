import{r as a,j as e,B as F,L as Y}from"./index-CoLzpuYL.js";import{e as ee,a as se,p as ae}from"./user-B6CrRgrx.js";import te from"./JobPostView-Gb_DH997.js";const ne=({enable:m,id:P})=>{console.log(m,"enableee");const[n,d]=a.useState(m),u=async N=>{try{console.log("toggled",N),d(N);const o=await ee({jobPostId:P,toggle:N});o.success?F.success(`${o.message}`):F.error(`${o.message}`)}catch(o){F.error(`${o.message}`)}};return e.jsx("div",{className:"toggle-container",children:e.jsx("div",{className:`toggle-switch ${n?"on":"off"}`,onClick:()=>u(!n),children:e.jsx("div",{className:"toggle-knob"})})})},re=()=>{const[m,P]=a.useState([]),[n,d]=a.useState(1),[u,N]=a.useState(1),[o,U]=a.useState(0),[C,k]=a.useState(!1),[V,L]=a.useState(!0),[R,A]=a.useState(!1),[Q,G]=a.useState(),[h,T]=a.useState(""),[l,_]=a.useState(""),[c,I]=a.useState(""),[D,J]=a.useState(""),[t,B]=a.useState(""),[i,O]=a.useState(""),[j,$]=a.useState("desc");a.useEffect(()=>{g(n,h,l,c,t,i,j)},[n]);const g=async(s,x="",f="",y="",v="",p="",S="desc")=>{try{k(!0);const b={page:s,...x&&{search:x},...f&&{startDate:f},...y&&{endDate:y},...v&&{paymentStatus:v},...p&&{sortBy:p},...S&&{sortOrder:S}};console.log("Fetching with params:",b);const r=await se(b);if(r.success){P(r.data);const w=r.totalPages||1;N(w),U(r==null?void 0:r.total)}else console.error("Failed to fetch jobs:",r.message||"Unknown error")}catch(b){console.error("Error fetching job posts:",b)}finally{k(!1),console.log(o,"Total Count________")}},H=()=>{n>1&&d(s=>s-1)},K=()=>{n<u&&d(s=>s+1)},W=s=>{s.preventDefault(),d(1),g(1,D,l,c,t,i,j),T(D)},Z=()=>{J(""),T(""),_(""),I(""),B(""),O(""),$("desc"),d(1),g(1,"","","","","","desc")},q=()=>{d(1),g(1,h,l,c,t,i,j)},E=s=>{d(1),B(s),g(1,h,l,c,s,i,j)},z=s=>{let x="desc";i===s&&(x=j==="desc"?"asc":"desc"),O(s),$(x),d(1),g(1,h,l,c,t,s,x)},M=s=>i!==s?e.jsx("i",{className:"fas fa-sort text-muted ms-1"}):j==="desc"?e.jsx("i",{className:"fas fa-sort-down ms-1"}):e.jsx("i",{className:"fas fa-sort-up ms-1"}),X=s=>{A(!0),L(!1),G(s)};return console.log(m,"jobposts"),e.jsxs(e.Fragment,{children:[V&&e.jsx("div",{className:"page-wrapper",children:e.jsx("div",{className:"content",children:e.jsxs("div",{children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("h5",{className:"mb-0",children:["Job Post List Count - ",o]}),(h||l||c||t||i)&&e.jsxs("div",{className:"active-filters",children:[e.jsx("span",{className:"badge bg-light text-dark me-2",children:"Active Filters:"}),h&&e.jsxs("span",{className:"badge bg-info me-2",children:['Search: "',h,'"']}),l&&e.jsxs("span",{className:"badge bg-info me-2",children:["From: ",new Date(l).toLocaleDateString()]}),c&&e.jsxs("span",{className:"badge bg-info me-2",children:["To: ",new Date(c).toLocaleDateString()]}),t&&e.jsxs("span",{className:"badge bg-info me-2",children:["Payment: ",t==="paid"?"Paid":"Unpaid"]}),i&&e.jsxs("span",{className:"badge bg-primary me-2",children:["Sorted by: ",i==="applicants"?"Applicants":i," (",j==="desc"?"Highest First":"Lowest First",")"]}),e.jsxs("button",{className:"btn btn-sm btn-outline-danger",onClick:Z,children:[e.jsx("i",{className:"fas fa-times me-1"}),"Clear All"]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("form",{onSubmit:W,className:"d-flex",children:[e.jsx("input",{type:"text",className:"form-control me-2",placeholder:"Search job title, company, business owner...",value:D,onChange:s=>J(s.target.value)}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-search me-1"}),"Search"]})]}),e.jsx("small",{className:"text-muted",children:"Search across job titles, descriptions, company names, or business owner details"})]}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"startDate",className:"form-label small",children:"Start Date"}),e.jsx("input",{type:"date",id:"startDate",className:"form-control",value:l,onChange:s=>_(s.target.value)})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",className:"form-label small",children:"End Date"}),e.jsx("input",{type:"date",id:"endDate",className:"form-control",value:c,onChange:s=>I(s.target.value)})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label small",children:"Payment Status"}),e.jsxs("div",{className:"btn-group w-100",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${t==="paid"?"btn-success":"btn-outline-success"}`,onClick:()=>E(t==="paid"?"":"paid"),children:"Paid"}),e.jsx("button",{type:"button",className:`btn btn-sm ${t==="unpaid"?"btn-warning":"btn-outline-warning"}`,onClick:()=>E(t==="unpaid"?"":"unpaid"),children:"Unpaid"})]})]})}),e.jsx("div",{className:"col-12 mt-2",children:e.jsxs("button",{className:"btn btn-secondary",onClick:q,disabled:!l&&!c,children:[e.jsx("i",{className:"fas fa-filter me-1"}),"Apply Date Filter"]})})]})})]})]})})}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("h4",{style:{textAlign:"center",fontWeight:"800",paddingTop:10,paddingBottom:25},children:["Job Post Total Count - ",o]}),C?e.jsxs("div",{className:"text-center my-4",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading job posts..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table border-0 comman-table datatable mb-0",style:{width:"100%",tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Address"}),e.jsx("th",{children:"Job Title"}),e.jsx("th",{children:"Business Owner"}),e.jsx("th",{children:"Phone Number"}),e.jsxs("th",{className:"cursor-pointer",onClick:()=>z("applicants"),children:["Applicants ",M("applicants")]}),e.jsx("th",{children:"Call Btn"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:m&&m.length>0?m.map((s,x)=>{var f,y,v,p,S,b,r,w;return e.jsxs("tr",{children:[e.jsx("td",{children:(n-1)*20+x+1}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((f=s==null?void 0:s.companyId)==null?void 0:f.companyLogo)||ae,alt:"",height:40,width:40,style:{borderRadius:"50%",marginRight:"10px"}}),e.jsx("p",{className:"mb-0",children:((y=s==null?void 0:s.companyId)==null?void 0:y.companyName)||"N/A"})]})}),e.jsx("td",{children:e.jsx("p",{className:"mb-0",children:((v=s==null?void 0:s.branchData)==null?void 0:v.address)||"N/A"})}),e.jsx("td",{children:((p=s==null?void 0:s.jobTitle)==null?void 0:p.title)||"N/A"}),e.jsx("td",{children:((S=s==null?void 0:s.userId)==null?void 0:S.name)||"-"}),e.jsx("td",{children:((b=s==null?void 0:s.userId)==null?void 0:b.phoneNumber)||"-"}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-info",children:((w=(r=s==null?void 0:s.applicants)==null?void 0:r.applicants)==null?void 0:w.length)||0})}),e.jsx("td",{children:e.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-100",children:e.jsx(ne,{enable:s==null?void 0:s.enableCallsfromB2c,id:s==null?void 0:s._id})})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s!=null&&s.paymentDone?"bg-success":"bg-warning"}`,children:(s==null?void 0:s.paymentDone)===!0?"Paid":"Unpaid"})}),e.jsx("td",{children:s.createdAt?new Date(s.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}):"-"}),e.jsx("td",{children:e.jsx(Y,{onClick:()=>X(s),state:{post:s},className:"btn btn-sm btn-primary",children:"View"})})]},s._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:e.jsxs("div",{className:"py-4",children:[e.jsx("i",{className:"fas fa-file-search fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No job posts found"}),(h||l||c||t||i)&&e.jsx("p",{children:"Try adjusting your search criteria or clear filters"})]})})})})]})})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:H,disabled:n===1||C,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Previous"]}),e.jsxs("div",{className:"pagination-info",children:[e.jsxs("span",{className:"fw-bold",children:["Page ",n," of ",u]}),e.jsxs("div",{className:"text-muted small",children:["Showing ",m.length," of ",u*20," job posts"]})]}),e.jsxs("button",{className:"btn btn-secondary",onClick:K,disabled:n>=u||C,children:["Next ",e.jsx("i",{className:"fas fa-chevron-right ms-1"})]})]})]})})}),R&&e.jsx(te,{post:Q,setListPage:L,setViewPage:A})]})};export{re as default};
